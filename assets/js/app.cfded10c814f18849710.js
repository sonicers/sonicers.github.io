webpackJsonp([1],{130:function(t,e,n){e=t.exports=n(12)(!1),e.push([t.i,"div[data-v-09ad1f51]{cursor:pointer}",""])},131:function(t,e,n){e=t.exports=n(12)(!1),e.push([t.i,'.demo-block{width:100%;height:100%;background-color:#fff;border-radius:3px}.demo-block .demo-block-preview{width:70%;height:100%;float:left;position:relative}.demo-block .demo-block-code{width:30%;height:100%;background:#f9fafc;border-left:1px solid #dfe2e7;font-size:13px;float:left}.demo-block .demo-block-code pre code{font:normal 10pt Consolas,Monaco,monospace}.demo-block .demo-block-code .demo-block-code-box{width:100%;height:50%;position:relative;overflow:hidden}.demo-block .demo-block-code-box:after{content:"";display:block;position:absolute;bottom:0;left:0;width:90%;height:1px;background:-webkit-linear-gradient(left,#dfe2e7 80%,rgba(223,226,231,0))}.demo-block .demo-block-code-box h3{width:100%;padding:10px 20px;font-size:16px;font-weight:700;position:absolute}.demo-block .demo-block-code-box-content{position:absolute;top:40px;bottom:10px;left:20px;right:20px;overflow:auto}.demo-block .hljs{background:transparent}.demo-block .demo-block-code code{position:absolute;top:0;left:0}',""])},132:function(t,e,n){e=t.exports=n(12)(!1),e.push([t.i,'*{margin:0;border:0;padding:0;box-sizing:border-box}li,ol,ul{list-style:none}a{color:#657180;text-decoration:none}.demos,body,html{width:100%;height:100%;color:#657180}body{background:#eee;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,PingFang SC,Hiragino Sans GB,Microsoft YaHei,SimSun,sans-serif;background:#fff}.demos-header{position:absolute;top:0;width:100%;background:#f3f6fb;text-shadow:0 1px 0 hsla(0,0%,100%,.5);border-bottom:1px solid #dfe2e7;padding:15px 15px 15px 30px;line-height:20px}.demos-header .title{font-weight:700;font-size:18px;display:inline-block}.demos-header .github{color:#39f;display:inline-block;font-size:12px;float:right}.demos-content{width:100%;height:100%;padding-top:52px;overflow:hidden}.demos-menu{float:left;width:230px;height:100%;border-right:1px solid #dfe2e7;padding:10px 30px}.demos-menu .demos-menu-item{display:block;width:100%;height:30px;line-height:30px;font-size:14px;cursor:pointer}.demos-menu .demos-menu-item>a{display:block;width:100%;height:100%}.demos-menu .demos-menu-title{display:block;width:100%;padding:6px 0;margin-top:10px;font-size:14px;font-weight:700}.demos-menu .demos-menu-item:hover>a{color:#39f}.demos-pages{height:100%;overflow:hidden}.demo-loading{position:absolute;top:0;left:0;width:100%;height:100%;text-align:center}.demo-loading:before{border-radius:100%;margin:2px;border:3px solid #20a0ff;border-bottom-color:transparent;height:36px;width:36px;animation:loading-rotate .75s 0s linear infinite}.demo-loading:after,.demo-loading:before{content:"";display:inline-block;vertical-align:middle}.demo-loading:after{height:100%;width:0}@keyframes loading-rotate{0%{transform:rotate(0) scale(1)}50%{transform:rotate(180deg) scale(.6)}to{transform:rotate(1turn) scale(1)}}',""])},133:function(t,e,n){e=t.exports=n(12)(!1),e.push([t.i,".info[data-v-2a5bfa54]{position:absolute;top:30px;left:10%}.info button[data-v-2a5bfa54]{padding:10px;cursor:pointer}",""])},134:function(t,e,n){e=t.exports=n(12)(!1),e.push([t.i,"div[data-v-66d382e3]{cursor:pointer}",""])},135:function(t,e,n){e=t.exports=n(12)(!1),e.push([t.i,".v-pano{width:100%;height:100%;margin:0;padding:0;border:0}",""])},136:function(t,e){},18:function(t,e,n){n(345);var i=n(3)(n(67),n(334),null,null);t.exports=i.exports},27:function(t,e,n){"use strict";(function(t,i,o){var r,r,a=n(81),s=n.n(a),h=n(78),c=n.n(h),l=n(77),d=n.n(l),u=n(76),p=n.n(u),f=n(79),m=n.n(f),v=n(85),g=n.n(v),y=n(82),w=n.n(y),b=n(80),E=n.n(b),x=n(41),M={REVISION:"9"},T=function(){function t(t,e,n,i){function o(n){r=e(o,i),t(n-(a||n)),a=n}var r,a;return{start:function(){r||o(0)},stop:function(){n(r),r=null,a=0}}}function e(e){return t(e,requestAnimationFrame,cancelAnimationFrame)}function n(t,e,n){function i(i){n&&!n(t,e)||i.stopImmediatePropagation()}return t.addEventListener(e,i),i}function i(t,e,n,i){function o(){return n[e]}function r(t){n[e]=t}i&&r(t[e]),E()(t,e,{get:o,set:r})}function o(t,e,n){n.addEventListener(e,function(){return t.dispatchEvent(new Event(e))})}function r(t,e){w.a.resolve().then(function(){t.dispatchEvent(new Event(e))})}function a(t){var e=new Audio;return o(t,"play",e),o(t,"playing",e),o(t,"pause",e),e.crossOrigin=t.crossOrigin,e.src=t.src||t.currentSrc||"data:",e}function s(t,e,n){(v||0)+200<Date.now()&&(t[x]=!0,v=Date.now()),n||(t.currentTime=e),L[++P%3]=100*e|0}function h(t){return t.driver.currentTime>=t.video.duration}function c(t){var e=this;e.video.readyState>=e.video.HAVE_FUTURE_DATA?(e.hasAudio||(e.driver.currentTime=e.video.currentTime+t*e.video.playbackRate/1e3,e.video.loop&&h(e)&&(e.driver.currentTime=0)),s(e.video,e.driver.currentTime)):e.video.networkState===e.video.NETWORK_IDLE&&0===e.video.buffered.length&&e.video.load(),e.video.ended&&(delete e.video[x],e.video.pause(!0))}function l(){var t=this,e=t[b];if(t.webkitDisplayingFullscreen)return void t[M]();"data:"!==e.driver.src&&e.driver.src!==t.src&&(s(t,0,!0),e.driver.src=t.src),t.paused&&(e.paused=!1,0===t.buffered.length&&t.load(),e.driver.play(),e.updater.start(),e.hasAudio||(r(t,"play"),e.video.readyState>=e.video.HAVE_ENOUGH_DATA&&r(t,"playing")))}function d(t){var e=this,n=e[b];n.driver.pause(),n.updater.stop(),e.webkitDisplayingFullscreen&&e[T](),n.paused&&!t||(n.paused=!0,n.hasAudio||r(e,"pause"),e.ended&&!e.webkitDisplayingFullscreen&&(e[x]=!0,r(e,"ended")))}function u(t,n){var i={};t[b]=i,i.paused=!0,i.hasAudio=n,i.video=t,i.updater=e(c.bind(i)),n?i.driver=a(t):(t.addEventListener("canplay",function(){t.paused||r(t,"playing")}),i.driver={src:t.src||t.currentSrc||"data:",muted:!0,paused:!0,pause:function(){i.driver.paused=!0},play:function(){i.driver.paused=!1,h(i)&&s(t,0)},get ended(){return h(i)}}),t.addEventListener("emptied",function(){var e=!i.driver.src||"data:"===i.driver.src;i.driver.src&&i.driver.src!==t.src&&(s(t,0,!0),i.driver.src=t.src,e||!n&&t.autoplay?i.driver.play():i.updater.stop())},!1),t.addEventListener("webkitbeginfullscreen",function(){t.paused?n&&0===i.driver.buffered.length&&i.driver.load():(t.pause(),t[M]())}),n&&(t.addEventListener("webkitendfullscreen",function(){i.driver.currentTime=t.currentTime}),t.addEventListener("seeking",function(){L.indexOf(100*t.currentTime|0)<0&&(i.driver.currentTime=t.currentTime)}))}function p(t){var e=t[x];return delete t[x],!t.webkitDisplayingFullscreen&&!e}function f(t){var e=t[b];t[M]=t.play,t[T]=t.pause,t.play=l,t.pause=d,i(t,"paused",e.driver),i(t,"muted",e.driver,!0),i(t,"playbackRate",e.driver,!0),i(t,"ended",e.driver),i(t,"loop",e.driver,!0),n(t,"seeking",function(t){return!t.webkitDisplayingFullscreen}),n(t,"seeked",function(t){return!t.webkitDisplayingFullscreen}),n(t,"timeupdate",p),n(t,"ended",p)}function m(t,e){if(void 0===e&&(e={}),!t[b]){if(!e.everywhere){if(!y)return;if(!(e.iPad||e.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))return}t.pause();var n=t.autoplay;t.autoplay=!1,u(t,!t.muted),f(t),t.classList.add("IIV"),t.muted&&n&&(t.play(),t.addEventListener("playing",function e(){t.autoplay=!0,t.removeEventListener("playing",e)})),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}}var v,y="object"===("undefined"==typeof document?"undefined":g()(document))&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,b="bfred-it:iphone-inline-video",x="bfred-it:iphone-inline-video:event",M="bfred-it:iphone-inline-video:nativeplay",T="bfred-it:iphone-inline-video:nativepause",L=[],P=0;return m}(),L=L||function(){var t=[];return{getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},update:function(e,n){if(0===t.length)return!1;var i=0;for(e=void 0!==e?e:L.now();i<t.length;)t[i].update(e)||n?i++:t.splice(i,1);return!0}}}();"undefined"==typeof window&&void 0!==t?L.now=function(){var e=t.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?L.now=window.performance.now.bind(window.performance):void 0!==Date.now?L.now=Date.now:L.now=function(){return(new Date).getTime()},L.Tween=function(t){var e,n=t,i={},o={},r={},a=1e3,s=0,h=!1,c=!1,l=!1,d=0,u=null,p=L.Easing.Linear.None,f=L.Interpolation.Linear,m=[],v=null,g=!1,y=null,w=null,b=null;this.to=function(t,e){return o=t,void 0!==e&&(a=e),this},this.start=function(t){L.add(this),c=!0,g=!1,u=void 0!==t?t:L.now(),u+=d;for(var e in o){if(o[e]instanceof Array){if(0===o[e].length)continue;o[e]=[n[e]].concat(o[e])}void 0!==n[e]&&(i[e]=n[e],i[e]instanceof Array==!1&&(i[e]*=1),r[e]=i[e]||0)}return this},this.stop=function(){return c?(L.remove(this),c=!1,null!==b&&b.call(n,n),this.stopChainedTweens(),this):this},this.end=function(){return this.update(u+a),this},this.stopChainedTweens=function(){for(var t=0,e=m.length;t<e;t++)m[t].stop()},this.delay=function(t){return d=t,this},this.repeat=function(t){return s=t,this},this.repeatDelay=function(t){return e=t,this},this.yoyo=function(t){return h=t,this},this.easing=function(t){return p=t,this},this.interpolation=function(t){return f=t,this},this.chain=function(){return m=arguments,this},this.onStart=function(t){return v=t,this},this.onUpdate=function(t){return y=t,this},this.onComplete=function(t){return w=t,this},this.onStop=function(t){return b=t,this},this.update=function(t){var c,b,E;if(t<u)return!0;!1===g&&(null!==v&&v.call(n,n),g=!0),b=(t-u)/a,b=b>1?1:b,E=p(b);for(c in o)if(void 0!==i[c]){var x=i[c]||0,M=o[c];M instanceof Array?n[c]=f(M,E):("string"==typeof M&&(M="+"===M.charAt(0)||"-"===M.charAt(0)?x+parseFloat(M):parseFloat(M)),"number"==typeof M&&(n[c]=x+(M-x)*E))}if(null!==y&&y.call(n,E),1===b){if(s>0){isFinite(s)&&s--;for(c in r){if("string"==typeof o[c]&&(r[c]=r[c]+parseFloat(o[c])),h){var T=r[c];r[c]=o[c],o[c]=T}i[c]=r[c]}return h&&(l=!l),u=void 0!==e?t+e:t+d,!0}null!==w&&w.call(n,n);for(var L=0,P=m.length;L<P;L++)m[L].start(u+a);return!1}return!0}},L.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-L.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*L.Easing.Bounce.In(2*t):.5*L.Easing.Bounce.Out(2*t-1)+.5}}},L.Interpolation={Linear:function(t,e){var n=t.length-1,i=n*e,o=Math.floor(i),r=L.Interpolation.Utils.Linear;return e<0?r(t[0],t[1],i):e>1?r(t[n],t[n-1],n-i):r(t[o],t[o+1>n?n:o+1],i-o)},Bezier:function(t,e){for(var n=0,i=t.length-1,o=Math.pow,r=L.Interpolation.Utils.Bernstein,a=0;a<=i;a++)n+=o(1-e,i-a)*o(e,a)*t[a]*r(i,a);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,o=Math.floor(i),r=L.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(o=Math.floor(i=n*(1+e))),r(t[(o-1+n)%n],t[o],t[(o+1)%n],t[(o+2)%n],i-o)):e<0?t[0]-(r(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(r(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):r(t[o?o-1:0],t[o],t[n<o+1?n:o+1],t[n<o+2?n:o+2],i-o)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=L.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var i=e;i>1;i--)n*=i;return t[e]=n,n}}(),CatmullRom:function(t,e,n,i,o){var r=.5*(n-t),a=.5*(i-e),s=o*o;return(2*e-2*n+r+a)*(o*s)+(-3*e+3*n-2*r-a)*s+r*o+e}}},function(t){"function"==typeof define&&n(351)?define([],function(){return L}):void 0!==i&&"object"===("undefined"==typeof exports?"undefined":g()(exports))?i.exports=L:void 0!==t&&(t.TWEEN=L)}(this),x.OrbitControls=function(t,e){function n(){return 2*Math.PI/60/60*b.autoRotateSpeed}function i(){return Math.pow(.95,b.zoomSpeed)}function o(t){if(B=!1,N=F=0,!1!==b.enabled){if(t.preventDefault(),t.button===b.mouseButtons.ORBIT){if(!0===b.noRotate)return;z=H.ROTATE,E.set(t.clientX,t.clientY)}else if(t.button===b.mouseButtons.ZOOM){if(!0===b.noZoom)return;z=H.DOLLY,A.set(t.clientX,t.clientY)}else if(t.button===b.mouseButtons.PAN){if(!0===b.noPan)return;z=H.PAN,L.set(t.clientX,t.clientY)}z!==H.NONE&&(document.addEventListener("mousemove",r,!1),document.addEventListener("mouseup",a,!1),b.dispatchEvent(X)),b.update()}}function r(t){if(!1!==b.enabled){t.preventDefault();var e=b.domElement===document?b.domElement.body:b.domElement;if(z===H.ROTATE){if(!0===b.noRotate)return;M.set(t.clientX,t.clientY),T.subVectors(M,E),b.rotateLeft(2*Math.PI*T.x/e.clientWidth*b.rotateSpeed),b.rotateUp(2*Math.PI*T.y/e.clientHeight*b.rotateSpeed),E.copy(M),m&&(N=t.clientX-m.clientX,F=t.clientY-m.clientY),m=t}else if(z===H.DOLLY){if(!0===b.noZoom)return;C.set(t.clientX,t.clientY),R.subVectors(C,A),R.y>0?b.dollyIn():R.y<0&&b.dollyOut(),A.copy(C)}else if(z===H.PAN){if(!0===b.noPan)return;P.set(t.clientX,t.clientY),I.subVectors(P,L),b.pan(I.x,I.y),L.copy(P)}z!==H.NONE&&b.update()}}function a(){B=!0,m=void 0,!1!==b.enabled&&(document.removeEventListener("mousemove",r,!1),document.removeEventListener("mouseup",a,!1),b.dispatchEvent(q),z=H.NONE)}function s(t){if(!1!==b.enabled&&!0!==b.noZoom&&z===H.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?(b.object.fov=b.object.fov<b.maxFov?b.object.fov+1:b.maxFov,b.object.updateProjectionMatrix()):e<0&&(b.object.fov=b.object.fov>b.minFov?b.object.fov-1:b.minFov,b.object.updateProjectionMatrix()),b.update(),b.dispatchEvent(G),b.dispatchEvent(X),b.dispatchEvent(q)}}function h(t){switch(t.keyCode){case b.keys.UP:v=!1;break;case b.keys.BOTTOM:g=!1;break;case b.keys.LEFT:y=!1;break;case b.keys.RIGHT:w=!1}}function c(t){if(!1!==b.enabled&&!0!==b.noKeys&&!0!==b.noRotate){switch(t.keyCode){case b.keys.UP:v=!0;break;case b.keys.BOTTOM:g=!0;break;case b.keys.LEFT:y=!0;break;case b.keys.RIGHT:w=!0}(v||g||y||w)&&(B=!0,v&&(F=-b.rotateSpeed*b.momentumKeydownFactor),g&&(F=b.rotateSpeed*b.momentumKeydownFactor),y&&(N=-b.rotateSpeed*b.momentumKeydownFactor),w&&(N=b.rotateSpeed*b.momentumKeydownFactor))}}function l(t){if(B=!1,N=F=0,!1!==b.enabled){switch(t.touches.length){case 1:if(!0===b.noRotate)return;z=H.TOUCH_ROTATE,E.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(!0===b.noZoom)return;z=H.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY;Math.sqrt(e*e+n*n);break;case 3:if(!0===b.noPan)return;z=H.TOUCH_PAN,L.set(t.touches[0].pageX,t.touches[0].pageY);break;default:z=H.NONE}z!==H.NONE&&b.dispatchEvent(X)}}function d(t){if(!1!==b.enabled){t.preventDefault(),t.stopPropagation();var e=b.domElement===document?b.domElement.body:b.domElement;switch(t.touches.length){case 1:if(!0===b.noRotate)return;if(z!==H.TOUCH_ROTATE)return;M.set(t.touches[0].pageX,t.touches[0].pageY),T.subVectors(M,E),b.rotateLeft(2*Math.PI*T.x/e.clientWidth*b.rotateSpeed),b.rotateUp(2*Math.PI*T.y/e.clientHeight*b.rotateSpeed),E.copy(M),m&&(N=t.touches[0].pageX-m.pageX,F=t.touches[0].pageY-m.pageY),m={pageX:t.touches[0].pageX,pageY:t.touches[0].pageY},b.update();break;case 2:if(!0===b.noZoom)return;if(z!==H.TOUCH_DOLLY)return;var n=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY;Math.sqrt(n*n+i*i);t.scale<1?(b.object.fov=b.object.fov<b.maxFov?b.object.fov+1:b.maxFov,b.object.updateProjectionMatrix()):t.scale>1&&(b.object.fov=b.object.fov>b.minFov?b.object.fov-1:b.minFov,b.object.updateProjectionMatrix()),b.update(),b.dispatchEvent(G);break;case 3:if(!0===b.noPan)return;if(z!==H.TOUCH_PAN)return;P.set(t.touches[0].pageX,t.touches[0].pageY),I.subVectors(P,L),b.pan(I.x,I.y),L.copy(P),b.update();break;default:z=H.NONE}}}function u(){B=!0,m=void 0,!1!==b.enabled&&(b.dispatchEvent(q),z=H.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.frameId,this.enabled=!0,this.target=new x.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=-.15,this.noPan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.momentumDampingFactor=.9,this.momentumScalingFactor=-.005,this.momentumKeydownFactor=20,this.minFov=30,this.maxFov=120,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:x.MOUSE.LEFT,ZOOM:x.MOUSE.MIDDLE,PAN:x.MOUSE.RIGHT};var p,f,m,v,g,y,w,b=this,E=new x.Vector2,M=new x.Vector2,T=new x.Vector2,L=new x.Vector2,P=new x.Vector2,I=new x.Vector2,S=new x.Vector3,O=new x.Vector3,A=new x.Vector2,C=new x.Vector2,R=new x.Vector2,D=0,_=0,k=1,V=new x.Vector3,U=new x.Vector3,j=new x.Quaternion,N=0,F=0,B=!1,H={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},z=H.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var W=(new x.Quaternion).setFromUnitVectors(t.up,new x.Vector3(0,1,0)),Y=W.clone().inverse(),G={type:"change"},X={type:"start"},q={type:"end"};this.setLastQuaternion=function(t){j.copy(t),b.object.quaternion.copy(t)},this.getLastPosition=function(){return U},this.rotateLeft=function(t){void 0===t&&(t=n()),_-=t},this.rotateUp=function(t){void 0===t&&(t=n()),D-=t},this.panLeft=function(t){var e=this.object.matrix.elements;S.set(e[0],e[1],e[2]),S.multiplyScalar(-t),V.add(S)},this.panUp=function(t){var e=this.object.matrix.elements;S.set(e[4],e[5],e[6]),S.multiplyScalar(t),V.add(S)},this.pan=function(t,e){var n=b.domElement===document?b.domElement.body:b.domElement;if(b.object instanceof x.PerspectiveCamera){var i=b.object.position,o=i.clone().sub(b.target),r=o.length();r*=Math.tan(b.object.fov/2*Math.PI/180),b.panLeft(2*t*r/n.clientHeight),b.panUp(2*e*r/n.clientHeight)}else b.object instanceof x.OrthographicCamera?(b.panLeft(t*(b.object.right-b.object.left)/n.clientWidth),b.panUp(e*(b.object.top-b.object.bottom)/n.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.momentum=function(){if(B){if(Math.abs(N)<1e-4&&Math.abs(F)<1e-4)return void(B=!1);F*=this.momentumDampingFactor,N*=this.momentumDampingFactor,_-=this.momentumScalingFactor*N,D-=this.momentumScalingFactor*F}},this.dollyIn=function(t){void 0===t&&(t=i()),b.object instanceof x.PerspectiveCamera?k/=t:b.object instanceof x.OrthographicCamera?(b.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),b.object.updateProjectionMatrix(),b.dispatchEvent(G)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=i()),b.object instanceof x.PerspectiveCamera?k*=t:b.object instanceof x.OrthographicCamera?(b.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),b.object.updateProjectionMatrix(),b.dispatchEvent(G)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(t){var e=this.object.position;O.copy(e).sub(this.target),O.applyQuaternion(W),p=Math.atan2(O.x,O.z),f=Math.atan2(Math.sqrt(O.x*O.x+O.z*O.z),O.y),this.autoRotate&&z===H.NONE&&this.rotateLeft(n()),this.momentum(),p+=_,f+=D,p=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,p)),f=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,f)),f=Math.max(1e-7,Math.min(Math.PI-1e-7,f));var i=O.length()*k;i=Math.max(this.minDistance,Math.min(this.maxDistance,i)),this.target.add(V),O.x=i*Math.sin(f)*Math.sin(p),O.y=i*Math.cos(f),O.z=i*Math.sin(f)*Math.cos(p),O.applyQuaternion(Y),e.copy(this.target).add(O),this.object.lookAt(this.target),_=0,D=0,k=1,V.set(0,0,0),(U.distanceToSquared(this.object.position)>1e-7||8*(1-j.dot(this.object.quaternion))>1e-7)&&(!0!==t&&this.dispatchEvent(G),U.copy(this.object.position),j.copy(this.object.quaternion))},this.reset=function(){z=H.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(G),this.update()},this.getPolarAngle=function(){return f},this.getAzimuthalAngle=function(){return p},this.domElement.addEventListener("mousedown",o,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",l,!1),this.domElement.addEventListener("touchend",u,!1),this.domElement.addEventListener("touchmove",d,!1),window.addEventListener("keyup",h,!1),window.addEventListener("keydown",c,!1),this.update()},x.OrbitControls.prototype=m()(x.EventDispatcher.prototype),x.OrbitControls.prototype.constructor=x.OrbitControls,x.DeviceOrientationControls=function(t,e){var n=this,i={type:"change"},o=0,r=0,a=0,s=0;this.camera=t,this.camera.rotation.reorder("YXZ"),this.domElement=void 0!==e?e:document,this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alpha=0,this.alphaOffsetAngle=0;var h=function(t){n.deviceOrientation=t},c=function(){n.screenOrientation=window.orientation||0},l=function(t){t.preventDefault(),t.stopPropagation(),a=t.touches[0].pageX,s=t.touches[0].pageY},d=function(t){t.preventDefault(),t.stopPropagation(),o+=x.Math.degToRad((t.touches[0].pageX-a)/4),r+=x.Math.degToRad((s-t.touches[0].pageY)/4),n.updateAlphaOffsetAngle(o),a=t.touches[0].pageX,s=t.touches[0].pageY},u=function(t,e,i,o,a){var s,h=new x.Vector3(0,0,1),c=new x.Euler,l=new x.Quaternion,d=new x.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),u=new x.Quaternion,p=new x.Quaternion;0==n.screenOrientation?(s=new x.Vector3(1,0,0),u.setFromAxisAngle(s,-r)):180==n.screenOrientation?(s=new x.Vector3(1,0,0),u.setFromAxisAngle(s,r)):90==n.screenOrientation?(s=new x.Vector3(0,1,0),u.setFromAxisAngle(s,r)):-90==n.screenOrientation&&(s=new x.Vector3(0,1,0),u.setFromAxisAngle(s,-r)),d.multiply(u),d.multiply(p),c.set(i,e,-o,"YXZ"),t.setFromEuler(c),t.multiply(d),t.multiply(l.setFromAxisAngle(h,-a))};this.connect=function(){c(),window.addEventListener("orientationchange",c,!1),window.addEventListener("deviceorientation",h,!1),window.addEventListener("deviceorientation",this.update.bind(this),!1),n.domElement.addEventListener("touchstart",l,!1),n.domElement.addEventListener("touchmove",d,!1),n.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",c,!1),window.removeEventListener("deviceorientation",h,!1),window.removeEventListener("deviceorientation",this.update.bind(this),!1),n.domElement.removeEventListener("touchstart",l,!1),n.domElement.removeEventListener("touchmove",d,!1),n.enabled=!1},this.update=function(t){if(!1!==n.enabled){var e=n.deviceOrientation.alpha?x.Math.degToRad(n.deviceOrientation.alpha)+this.alphaOffsetAngle:0,o=n.deviceOrientation.beta?x.Math.degToRad(n.deviceOrientation.beta):0,r=n.deviceOrientation.gamma?x.Math.degToRad(n.deviceOrientation.gamma):0,a=n.screenOrientation?x.Math.degToRad(n.screenOrientation):0;u(n.camera.quaternion,e,o,r,a),this.alpha=e,!0!==t&&this.dispatchEvent(i)}},this.updateAlphaOffsetAngle=function(t){this.alphaOffsetAngle=t,this.update()},this.dispose=function(){this.disconnect()},this.connect()},x.DeviceOrientationControls.prototype=m()(x.EventDispatcher.prototype),x.DeviceOrientationControls.prototype.constructor=x.DeviceOrientationControls,x.BendModifier=function(){},x.BendModifier.prototype={constructor:x.BendModifier,set:function(t,e,n){return this.direction=new x.Vector3,this.direction.copy(t),this.axis=new x.Vector3,this.axis.copy(e),this.angle=n,this},_sign:function(t){return t<0?-1:t>0?1:0},_cosh:function(t){return(Math.exp(t)+Math.exp(-t))/2},_sinhInverse:function(t){return Math.log(Math.abs(t)+Math.sqrt(t*t+1))},modify:function(t){var e=new x.Vector3;e.crossVectors(this.direction,this.axis);var n=new x.Matrix4;n.set(e.x,e.y,e.z,0,this.direction.x,this.direction.y,this.direction.z,0,this.axis.x,this.axis.y,this.axis.z,0,0,0,0,1).transpose();for(var i=(new x.Matrix4).getInverse(n),o=[],r=[],a=[],s=0,h=0,c=0,l=0,d=0;d<t.vertices.length;d++)o[d]=new x.Vector3,o[d].copy(t.vertices[d]).applyMatrix4(i),o[d].x>s&&(s=o[d].x),o[d].x<h&&(h=o[d].x),o[d].y>c&&(c=o[d].y),o[d].y<l&&(l=o[d].y);for(var u=s-h,p=c-l,f=2*this._sinhInverse(Math.tan(this.angle))/u,m=(s+h)/2,v=(c+l)/2,d=0;d<t.vertices.length;d++)r[d]=new x.Vector3,r[d].copy(o[d]),o[d].x=1*this._sign(o[d].x-m)/f*this._sinhInverse((o[d].x-m)*f);var g=2/f*this._sinhInverse(u/2*f),y=2*this._sinhInverse(Math.tan(this.angle))/g,w=new x.Vector3(g/2,-p/2,0);w.y=1/y*this._cosh(y*w.x)-1/y-p/2;for(var b=new x.Vector3(0,w.y+w.x/Math.tan(this.angle),0),d=0;d<t.vertices.length;d++){var E=1*this._sign(r[d].x-m)/f*this._sinhInverse((r[d].x-m)*f),M=1/y*this._cosh(y*E)-1/y,T=new x.Vector3(b.x-E,b.y-(M-p/2),b.z).normalize(),L=new x.Vector3;L.addVectors(new x.Vector3(E,M-p/2,r[d].z),T.multiplyScalar(r[d].y+p/2)),o[d].x=L.x,o[d].y=L.y}for(var P=m*g/u,d=0;d<t.vertices.length;d++){var I=new x.Vector3(m,v,r[d].z);(new x.Vector3).subVectors(r[d],I);(new x.Vector3).subVectors(o[d],I),a[d]=Math.acos(1/this._cosh(f*o[d].x))*this._sign(o[d].x),o[d].x=o[d].x+P,t.vertices[d].copy(o[d].applyMatrix4(n))}t.computeFaceNormals(),t.verticesNeedUpdate=!0,t.normalsNeedUpdate=!0;for(var S=["a","b","c","d"],O=0,A=t.faces.length;O<A;O++){var C=t.faces[O];if(void 0!==C.vertexNormals)for(var R=0,D=C.vertexNormals.length;R<D;R++){var _=a[C[S[R]]],k=this.axis.x,V=this.axis.y,U=this.axis.z,j=new x.Matrix3;j.set(Math.cos(_)+(1-Math.cos(_))*k*k,(1-Math.cos(_))*k*V-Math.sin(_)*U,(1-Math.cos(_))*k*U+Math.sin(_)*V,(1-Math.cos(_))*V*k+Math.sin(_)*U,Math.cos(_)+(1-Math.cos(_))*V*V,(1-Math.cos(_))*V*U-Math.sin(_)*k,(1-Math.cos(_))*U*k-Math.sin(_)*V,(1-Math.cos(_))*U*V+Math.sin(_)*k,Math.cos(_)+(1-Math.cos(_))*U*U),C.vertexNormals[R].applyMatrix3(j)}}return this}},x.CardboardEffect=function(t){var e=new x.OrthographicCamera(-1,1,1,-1,0,1),n=new x.Scene,i=new x.StereoCamera;i.aspect=.5;var o={minFilter:x.LinearFilter,magFilter:x.NearestFilter,format:x.RGBAFormat},r=new x.WebGLRenderTarget(512,512,o);r.scissorTest=!0,r.texture.generateMipmaps=!1;var a=new x.Vector2(.441,.156),s=new x.PlaneBufferGeometry(1,1,10,20).removeAttribute("normal").toNonIndexed(),h=s.attributes.position.array,c=s.attributes.uv.array;s.attributes.position.count*=2,s.attributes.uv.count*=2;var l=new Float32Array(2*h.length);l.set(h),l.set(h,h.length);var d=new Float32Array(2*c.length);d.set(c),d.set(c,c.length);for(var u=new x.Vector2,p=h.length/3,f=0,m=l.length/3;f<m;f++){u.x=l[3*f+0],u.y=l[3*f+1];var v=u.dot(u),g=1.5+(a.x+a.y*v)*v,y=f<p?0:1;l[3*f+0]=u.x/g*1.5-.5+y,l[3*f+1]=u.y/g*3,d[2*f]=.5*(d[2*f]+y)}s.attributes.position.array=l,s.attributes.uv.array=d;var w=new x.MeshBasicMaterial({map:r.texture}),b=new x.Mesh(s,w);n.add(b),this.setSize=function(e,n){t.setSize(e,n);var i=t.getPixelRatio();r.setSize(e*i,n*i)},this.render=function(o,a){o.updateMatrixWorld(),null===a.parent&&a.updateMatrixWorld(),i.update(a);var s=r.width/2,h=r.height;r.scissor.set(0,0,s,h),r.viewport.set(0,0,s,h),t.render(o,i.cameraL,r),r.scissor.set(s,0,s,h),r.viewport.set(s,0,s,h),t.render(o,i.cameraR,r),t.render(n,e)}},x.StereoEffect=function(t){var e=new x.StereoCamera;e.aspect=.5,this.setEyeSeparation=function(t){e.eyeSep=t},this.setSize=function(e,n){t.setSize(e,n)},this.render=function(n,i){n.updateMatrixWorld(),null===i.parent&&i.updateMatrixWorld(),e.update(i);var o=t.getSize();t.autoClear&&t.clear(),t.setScissorTest(!0),t.setScissor(0,0,o.width/2,o.height),t.setViewport(0,0,o.width/2,o.height),t.render(n,e.cameraL),t.setScissor(o.width/2,0,o.width/2,o.height),t.setViewport(o.width/2,0,o.width/2,o.height),t.render(n,e.cameraR),t.setScissorTest(!1)}};var P=P||{};P.PanoLoader=function(t){var e,n,i=t||{},o=new google.maps.StreetViewService,r=0,a=0,s=[],h=[],c=0,l=0,d="",u=[1,2,4,7,13,26],p=[1,1,2,4,7,13],f=[416,832,1664,3328,6656,13312],m=[416,416,832,1664,3328,6656],v=null;try{var g=document.createElement("canvas");v=g.getContext("experimental-webgl"),null==v&&(v=g.getContext("webgl"))}catch(t){}var y=1024,w=1024;if(v){var b=Math.max(v.getParameter(v.MAX_TEXTURE_SIZE),6656);y=w=b}this.setProgress=function(t,e){this.onProgress&&this.onProgress({loaded:t,total:e})},this.throwError=function(t){this.onError?this.onError(t):console.error(t)},this.adaptTextureToZoom=function(){var t=416*u[e],n=416*p[e];t=f[e],n=m[e],c=Math.ceil(t/y),l=Math.ceil(n/w),s=[],h=[];for(var i=0,o=0;o<l;o++)for(var r=0;r<c;r++){var a=document.createElement("canvas");a.width=r<c-1?y:t-y*r,a.height=o<l-1?w:n-w*o,s.push(a),h.push(a.getContext("2d")),i++}},this.composeFromTile=function(t,e,n){t*=512,e*=512;var i=Math.floor(t/y),o=Math.floor(e/w);t-=i*y,e-=o*w,h[o*c+i].drawImage(n,0,0,n.width,n.height,t,e,512,512),this.progress()},this.progress=function(){r++;Math.round(100*r/a);this.setProgress(r,a),r===a&&(this.canvas=s,this.panoId=n,this.zoom=e,this.onPanoramaLoad&&this.onPanoramaLoad(s[0]))},this.loadFromId=function(t){n=t,this.composePanorama()},this.composePanorama=function(){this.setProgress(0,1);var t,o,s,h=u[e],c=p[e],l=this;r=0,a=h*c;for(var l=this,s=0;s<c;s++)for(var o=0;o<h;o++){var t="https://geo0.ggpht.com/cbk?cb_client=maps_sv.tactile&authuser=0&hl=en&output=tile&zoom="+e+"&x="+o+"&y="+s+"&panoid="+n+"&nbt&fover=2";!function(e,n){if(i.useWebGL)var o=x.ImageUtils.loadTexture(t,null,function(){l.composeFromTile(e,n,o)});else{var r=new Image;r.addEventListener("load",function(){l.composeFromTile(e,n,this)}),r.crossOrigin="",r.src=t}}(o,s)}},this.load=function(t){this.loadPano(t)},this.loadPano=function(t){var e=this;o.getPanoramaById(t,function(t,i){i===google.maps.StreetViewStatus.OK?(e.result=t,e.onPanoramaData&&e.onPanoramaData(t),d=t.copyright,e.copyright=t.copyright,n=t.location.pano,e.location=location,e.composePanorama()):(e.onNoPanoramaData&&e.onNoPanoramaData(i),e.throwError("Could not retrieve panorama for the following reason: "+i))})},this.setZoom=function(t){e=t,this.adaptTextureToZoom()},this.setZoom(i.zoom||1)},function(){M.DataImageSource="https://pchen66.github.io/Panolens/asset/icon/",M.DataImage={Info:M.DataImageSource+"information.png",Arrow:M.DataImageSource+"arrow-up.png",FullscreenEnter:M.DataImageSource+"fullscreen.png",FullscreenLeave:M.DataImageSource+"fullscreen-exit.png",VideoPlay:M.DataImageSource+"video-play.png",VideoPause:M.DataImageSource+"pause.png",WhiteTile:M.DataImageSource+"tiles.png",ReticleIdle:M.DataImageSource+"reticle-idle.png",Setting:M.DataImageSource+"setting.png",ChevronRight:M.DataImageSource+"chevron-right.png",Check:M.DataImageSource+"check.png",ViewIndicator:M.DataImageSource+"view-indicator.svg",ReticleDwell:M.DataImageSource+"reticle-animation.png"}}(),function(){M.Controls={ORBIT:0,DEVICEORIENTATION:1},M.Modes={UNKNOWN:0,NORMAL:1,CARDBOARD:2,STEREO:3}}(),function(){M.Utils={},M.Utils.checkTouchSupported=function(){return!!window&&("ontouchstart"in window||window.navigator.msMaxTouchPoints)}}(),function(){M.Utils.ImageLoader={},M.Utils.ImageLoader.load=function(t,e,n,i){function o(){c.revokeObjectURL(l.src),e&&e(l)}var r,a,s,h,c,l,d;for(var u in M.DataImage)M.DataImage.hasOwnProperty(u)&&t===M.DataImage[u]&&(d=u);return void 0!==(r=x.Cache.get(d||t))?(e&&setTimeout(function(){n&&n({loaded:1,total:1}),e(r)},0),r):(c=window.URL||window.webkitURL,l=document.createElementNS("http://www.w3.org/1999/xhtml","img"),x.Cache.add(d||t,l),0===t.indexOf("data:")?(l.addEventListener("load",o,!1),l.src=t,l):(l.crossOrigin=void 0!==this.crossOrigin?this.crossOrigin:"",a=new XMLHttpRequest,a.open("GET",t,!0),a.responseType="arraybuffer",a.onprogress=function(t){t.lengthComputable&&n&&n({loaded:t.loaded,total:t.total})},a.onloadend=function(t){s=new Uint8Array(this.response),h=new Blob([s]),l.addEventListener("load",o,!1),l.src=c.createObjectURL(h)},void a.send(null)))},x.Cache.enabled=!0}(),function(){M.Utils.TextureLoader={},M.Utils.TextureLoader.load=function(t,e,n,i){var o=new x.Texture;return M.Utils.ImageLoader.load(t,function(t){o.image=t,o.needsUpdate=!0,e&&e(o)},n,i),o}}(),function(){M.Utils.CubeTextureLoader={},M.Utils.CubeTextureLoader.load=function(t,e,n,i){var o,r,a,s,h;return o=new x.CubeTexture([]),r=0,a={},s={},t.map(function(t,c){M.Utils.ImageLoader.load(t,function(t){o.images[c]=t,6===++r&&(o.needsUpdate=!0,e&&e(o))},function(t){a[c]={loaded:t.loaded,total:t.total},s.loaded=0,s.total=0,h=0;for(var e in a)h++,s.loaded+=a[e].loaded,s.total+=a[e].total;h<6&&(s.total=s.total/h*6),n&&n(s)},i)}),o}}(),M.StereographicShader={uniforms:{tDiffuse:{value:new x.Texture},resolution:{value:1},transform:{value:new x.Matrix4},zoom:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float resolution;","uniform mat4 transform;","uniform float zoom;","varying vec2 vUv;","const float PI = 3.141592653589793;","void main(){","vec2 position = -1.0 +  2.0 * vUv;","position *= vec2( zoom * resolution, zoom * 0.5 );","float x2y2 = position.x * position.x + position.y * position.y;","vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );","sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );","vec2 sampleUV = vec2(","(atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,","(asin(sphere_pnt.z) / PI + 0.5)",");","gl_FragColor = texture2D( tDiffuse, sampleUV );","}"].join("\n")},function(){M.Panorama=function(t,e){x.Mesh.call(this),this.type="panorama",this.ImageQualityLow=1,this.ImageQualityFair=2,this.ImageQualityMedium=3,this.ImageQualityHigh=4,this.ImageQualitySuperHigh=5,this.animationDuration=1e3,this.defaultInfospotSize=350,this.container=void 0,this.loaded=!1,this.linkedSpots=[],this.isInfospotVisible=!1,this.linkingImageURL=void 0,this.linkingImageScale=void 0,this.geometry=t,this.material=e,this.material.side=x.DoubleSide,this.material.visible=!1,this.scale.x*=-1,this.infospotAnimation=new L.Tween(this).to({},this.animationDuration/2),this.addEventListener("load",this.fadeIn.bind(this)),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("click",this.onClick.bind(this)),this.setupTransitions()},M.Panorama.prototype=m()(x.Mesh.prototype),M.Panorama.prototype.constructor=M.Panorama,M.Panorama.prototype.add=function(t){var e,n;if(e=this,arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}t instanceof M.Infospot?(n=t,t.dispatchEvent&&(this.container&&t.dispatchEvent({type:"panolens-container",container:this.container}),t.dispatchEvent({type:"panolens-infospot-focus",method:function(t,n,i){e.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[t,n,i]})}}))):(n=new x.Object3D,n.scale.x=-1,n.scalePlaceHolder=!0,n.add(t)),x.Object3D.prototype.add.call(this,n)},M.Panorama.prototype.load=function(){this.onLoad()},M.Panorama.prototype.onClick=function(t){t.intersects&&0===t.intersects.length&&this.traverse(function(t){t.dispatchEvent({type:"dismiss"})})},M.Panorama.prototype.setContainer=function(t){var e;t instanceof HTMLElement?e=t:t&&t.container&&(e=t.container),e&&(this.children.forEach(function(t){t instanceof M.Infospot&&t.dispatchEvent&&t.dispatchEvent({type:"panolens-container",container:e})}),this.container=e)},M.Panorama.prototype.onLoad=function(){this.loaded=!0,this.dispatchEvent({type:"load"})},M.Panorama.prototype.onProgress=function(t){this.dispatchEvent({type:"progress",progress:t})},M.Panorama.prototype.onError=function(){this.dispatchEvent({type:"error"})},M.Panorama.prototype.getZoomLevel=function(){return window.innerWidth<=800?this.ImageQualityFair:window.innerWidth>800&&window.innerWidth<=1280?this.ImageQualityMedium:window.innerWidth>1280&&window.innerWidth<=1920?this.ImageQualityHigh:window.innerWidth>1920?this.ImageQualitySuperHigh:this.ImageQualityLow},M.Panorama.prototype.updateTexture=function(t){this.material.map=t,this.material.needsUpdate=!0},M.Panorama.prototype.toggleInfospotVisibility=function(t,e){e=void 0!==e?e:0;var n,i;n=this,i=void 0!==t?t:!this.isInfospotVisible,this.traverse(function(t){t instanceof M.Infospot&&(i?t.show(e):t.hide(e))}),this.isInfospotVisible=i,this.infospotAnimation.onComplete(function(){n.dispatchEvent({type:"infospot-animation-complete",visible:i})}).delay(e).start()},M.Panorama.prototype.setLinkingImage=function(t,e){this.linkingImageURL=t,this.linkingImageScale=e},M.Panorama.prototype.link=function(t,e,n,i){var o,r,a,s=this;if(this.visible=!0,!e)return void console.warn("Please specify infospot position for linking");r=void 0!==n?n:void 0!==t.linkingImageScale?t.linkingImageScale:300,a=i||(t.linkingImageURL?t.linkingImageURL:M.DataImage.Arrow),o=new M.Infospot(r,a),o.position.copy(e),o.toPanorama=t,o.addEventListener("click",function(){s.dispatchEvent({type:"panolens-viewer-handler",method:"setPanorama",data:t})}),this.linkedSpots.push(o),this.add(o),this.visible=!1},M.Panorama.prototype.reset=function(){this.children.length=0},M.Panorama.prototype.setupTransitions=function(){this.fadeInAnimation=new L.Tween(this.material).easing(L.Easing.Quartic.Out).onStart(function(){this.visible=!0,this.material.visible=!0,this.dispatchEvent({type:"enter-fade-start"})}.bind(this)),this.fadeOutAnimation=new L.Tween(this.material).easing(L.Easing.Quartic.Out).onComplete(function(){this.visible=!1,this.material.visible=!0,this.dispatchEvent({type:"leave-complete"})}.bind(this)),this.enterTransition=new L.Tween(this).easing(L.Easing.Quartic.Out).onComplete(function(){this.dispatchEvent({type:"enter-animation-complete"})}.bind(this)).start(),this.leaveTransition=new L.Tween(this).easing(L.Easing.Quartic.Out)},M.Panorama.prototype.fadeIn=function(t){t=t>=0?t:this.animationDuration,this.fadeOutAnimation.stop(),this.fadeInAnimation.to({opacity:1},t).onComplete(function(){this.toggleInfospotVisibility(!0,t/2),this.dispatchEvent({type:"enter-fade-complete"})}.bind(this)).start()},M.Panorama.prototype.fadeOut=function(t){t=t>=0?t:this.animationDuration,this.fadeInAnimation.stop(),this.fadeOutAnimation.to({opacity:0},t).start()},M.Panorama.prototype.onEnter=function(){var t=this.animationDuration;this.leaveTransition.stop(),this.enterTransition.to({},t).onStart(function(){this.dispatchEvent({type:"enter-animation-start"}),this.loaded?this.fadeIn(t):this.load()}.bind(this)).start(),this.dispatchEvent({type:"enter"})},M.Panorama.prototype.onLeave=function(){var t=this.animationDuration;this.enterTransition.stop(),this.leaveTransition.to({},t).onStart(function(){this.dispatchEvent({type:"leave-animation-start"}),this.fadeOut(t),this.toggleInfospotVisibility(!1)}.bind(this)).start(),this.dispatchEvent({type:"leave"})},M.Panorama.prototype.dispose=function(){function t(e){for(var n=e.children.length-1;n>=0;n--)t(e.children[n]),e.remove(e.children[n]);e instanceof M.Infospot&&e.dispose(),e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}this.dispatchEvent({type:"panolens-viewer-handler",method:"onPanoramaDispose",data:this}),t(this),this.parent&&this.parent.remove(this)}}(),function(){M.ImagePanorama=function(t,e){e=e||5e3;var n=new x.SphereGeometry(e,60,40),i=new x.MeshBasicMaterial({opacity:0,transparent:!0});M.Panorama.call(this,n,i),this.src=t},M.ImagePanorama.prototype=m()(M.Panorama.prototype),M.ImagePanorama.prototype.constructor=M.ImagePanorama,M.ImagePanorama.prototype.load=function(t){t=t||this.src,t?"string"==typeof t?M.Utils.TextureLoader.load(t,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this)):t instanceof HTMLImageElement&&this.onLoad(new x.Texture(t)):console.warn("Image source undefined")},M.ImagePanorama.prototype.onLoad=function(t){t.minFilter=t.magFilter=x.LinearFilter,t.needsUpdate=!0,this.updateTexture(t),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){M.Panorama.prototype.onLoad.call(this)}.bind(this))}.bind(this))},M.ImagePanorama.prototype.reset=function(){M.Panorama.prototype.reset.call(this)}}(),function(){M.GoogleStreetviewPanorama=function(t,e){M.ImagePanorama.call(this,void 0,e),this.panoId=t,this.gsvLoader=void 0,this.loadRequested=!1,this.setupGoogleMapAPI()},M.GoogleStreetviewPanorama.prototype=m()(M.ImagePanorama.prototype),M.GoogleStreetviewPanorama.constructor=M.GoogleStreetviewPanorama,M.GoogleStreetviewPanorama.prototype.load=function(t){this.loadRequested=!0,t=t||this.panoId||{},t&&this.gsvLoader?this.loadGSVLoader(t):this.gsvLoader={}},M.GoogleStreetviewPanorama.prototype.setupGoogleMapAPI=function(){var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js",t.onreadystatechange=this.setGSVLoader.bind(this),t.onload=this.setGSVLoader.bind(this),document.getElementsByTagName("head")[0].appendChild(t)},M.GoogleStreetviewPanorama.prototype.setGSVLoader=function(){this.gsvLoader=new P.PanoLoader,(this.gsvLoader==={}||this.loadRequested)&&this.load()},M.GoogleStreetviewPanorama.prototype.getGSVLoader=function(){return this.gsvLoader},M.GoogleStreetviewPanorama.prototype.loadGSVLoader=function(t){this.loadRequested=!1,this.gsvLoader.onProgress=this.onProgress.bind(this),this.gsvLoader.onPanoramaLoad=this.onLoad.bind(this),this.gsvLoader.setZoom(this.getZoomLevel()),this.gsvLoader.load(t),this.gsvLoader.loaded=!0},M.GoogleStreetviewPanorama.prototype.onLoad=function(t){this.gsvLoader&&M.ImagePanorama.prototype.onLoad.call(this,new x.Texture(t))},M.GoogleStreetviewPanorama.prototype.reset=function(){this.gsvLoader=void 0,M.ImagePanorama.prototype.reset.call(this)}}(),function(){M.CubePanorama=function(t,e){var n,i,o;this.images=t||[],e=e||1e4,n=JSON.parse(p()(x.ShaderLib.cube)),i=new x.BoxGeometry(e,e,e),o=new x.ShaderMaterial({fragmentShader:n.fragmentShader,vertexShader:n.vertexShader,uniforms:n.uniforms,side:x.BackSide}),M.Panorama.call(this,i,o)},M.CubePanorama.prototype=m()(M.Panorama.prototype),M.CubePanorama.prototype.constructor=M.CubePanorama,M.CubePanorama.prototype.load=function(){M.Utils.CubeTextureLoader.load(this.images,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this))},M.CubePanorama.prototype.onLoad=function(t){this.material.uniforms.tCube.value=t,M.Panorama.prototype.onLoad.call(this)}}(),function(){M.BasicPanorama=function(t){var e=M.DataImage.WhiteTile;M.CubePanorama.call(this,[e,e,e,e,e,e],t)},M.BasicPanorama.prototype=m()(M.CubePanorama.prototype),M.BasicPanorama.prototype.constructor=M.BasicPanorama}(),function(){M.VideoPanorama=function(t,e,n){n=n||5e3;var i=new x.SphereGeometry(n,60,40),o=new x.MeshBasicMaterial({opacity:0,transparent:!0});M.Panorama.call(this,i,o),this.src=t,this.options=e||{},this.options.playsinline=!1!==this.options.playsinline,this.videoElement=void 0,this.videoRenderObject=void 0,this.videoProgress=0,this.isIOS=/iPhone|iPad|iPod/i.test(navigator.userAgent),this.isMobile=this.isIOS||/Android|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent),this.addEventListener("leave",this.pauseVideo.bind(this)),this.addEventListener("enter-fade-start",this.resumeVideoProgress.bind(this)),this.addEventListener("video-toggle",this.toggleVideo.bind(this)),this.addEventListener("video-time",this.setVideoCurrentTime.bind(this))},M.VideoPanorama.prototype=m()(M.Panorama.prototype),M.VideoPanorama.constructor=M.VideoPanorama,M.VideoPanorama.prototype.load=function(t,e){var n=this;t=t||this.src||"",e=e||this.options||{},this.videoElement=e.videoElement||document.createElement("video"),this.videoElement.muted=e.muted||!1,this.videoElement.loop=void 0===e.loop||e.loop,this.videoElement.autoplay=void 0!==e.autoplay&&e.autoplay,this.videoElement.crossOrigin=void 0!==e.crossOrigin?e.crossOrigin:"anonymous",e.playsinline&&(this.videoElement.setAttribute("playsinline",""),this.videoElement.setAttribute("webkit-playsinline",""));var i=function(){n.onProgress({loaded:1,total:1}),n.setVideoTexture(n.videoElement),n.videoElement.autoplay&&n.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}),n.isMobile&&(n.videoElement.autoplay&&n.videoElement.muted?n.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}):n.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})),n.onLoad()};this.videoElement.readyState>2?i():(this.videoElement.querySelectorAll("source").length&&this.videoElement.src||(this.videoElement.src=t),this.videoElement.load()),this.videoElement.onloadeddata=i,this.videoElement.ontimeupdate=function(t){n.videoProgress=this.duration>=0?this.currentTime/this.duration:0,n.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:n.videoProgress})},this.videoElement.addEventListener("ended",function(){n.options.loop||(n.resetVideo(),n.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}))},!1)},M.VideoPanorama.prototype.setVideoTexture=function(t){var e,n;t&&(e=new x.VideoTexture(t),e.minFilter=x.LinearFilter,e.magFilter=x.LinearFilter,e.format=x.RGBFormat,n={video:t,videoTexture:e},this.isIOS&&T(t),this.updateTexture(e),this.videoRenderObject=n)},M.VideoPanorama.prototype.reset=function(){this.videoElement=void 0,M.Panorama.prototype.reset.call(this)},M.VideoPanorama.prototype.isVideoPaused=function(){return this.videoRenderObject.video.paused},M.VideoPanorama.prototype.toggleVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&(this.isVideoPaused()?this.videoRenderObject.video.play():this.videoRenderObject.video.pause())},M.VideoPanorama.prototype.setVideoCurrentTime=function(t){this.videoRenderObject&&this.videoRenderObject.video&&!d()(t.percentage)&&1!==t.percentage&&(this.videoRenderObject.video.currentTime=this.videoRenderObject.video.duration*t.percentage,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:t.percentage}))},M.VideoPanorama.prototype.playVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&this.isVideoPaused()&&this.videoRenderObject.video.play(),this.dispatchEvent({type:"play"})},M.VideoPanorama.prototype.pauseVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&!this.isVideoPaused()&&this.videoRenderObject.video.pause(),this.dispatchEvent({type:"pause"})},M.VideoPanorama.prototype.resumeVideoProgress=function(){this.videoElement.autoplay&&!this.isMobile?(this.playVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1})):(this.pauseVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0})),this.setVideoCurrentTime({percentage:this.videoProgress})},M.VideoPanorama.prototype.resetVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&this.setVideoCurrentTime({percentage:0})},M.VideoPanorama.prototype.isVideoMuted=function(){return this.videoRenderObject.video.muted},M.VideoPanorama.prototype.muteVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&!this.isVideoMuted()&&(this.videoRenderObject.video.muted=!0),this.dispatchEvent({type:"volumechange"})},M.VideoPanorama.prototype.unmuteVideo=function(){this.videoRenderObject&&this.videoRenderObject.video&&this.isVideoMuted()&&(this.videoRenderObject.video.muted=!1),this.dispatchEvent({type:"volumechange"})},M.VideoPanorama.prototype.getVideoElement=function(){return this.videoRenderObject.video},M.VideoPanorama.prototype.dispose=function(){this.resetVideo(),this.pauseVideo(),this.removeEventListener("leave",this.pauseVideo.bind(this)),this.removeEventListener("enter-fade-start",this.resumeVideoProgress.bind(this)),this.removeEventListener("video-toggle",this.toggleVideo.bind(this)),this.removeEventListener("video-time",this.setVideoCurrentTime.bind(this)),M.Panorama.prototype.dispose.call(this)}}(),function(){M.EmptyPanorama=function(t){t=t||5e3;var e=new x.Geometry,n=new x.MeshBasicMaterial({color:0,opacity:1,transparent:!0});M.Panorama.call(this,e,n)},M.EmptyPanorama.prototype=m()(M.Panorama.prototype),M.EmptyPanorama.prototype.constructor=M.EmptyPanorama}(),function(){M.LittlePlanet=function(t,e,n,i){t=t||"image","image"===t&&M.ImagePanorama.call(this,e,n),this.size=n||1e4,this.ratio=i||.5,this.EPS=1e-6,this.frameId,this.geometry=this.createGeometry(),this.material=this.createMaterial(this.size),this.dragging=!1,this.userMouse=new x.Vector2,this.quatA=new x.Quaternion,this.quatB=new x.Quaternion,this.quatCur=new x.Quaternion,this.quatSlerp=new x.Quaternion,this.vectorX=new x.Vector3(1,0,0),this.vectorY=new x.Vector3(0,1,0),this.addEventListener("window-resize",this.onWindowResize)},M.LittlePlanet.prototype=m()(M.ImagePanorama.prototype),M.LittlePlanet.prototype.constructor=M.LittlePlanet,M.LittlePlanet.prototype.createGeometry=function(){return new x.PlaneGeometry(this.size,this.size*this.ratio)},M.LittlePlanet.prototype.createMaterial=function(t){var e=M.StereographicShader.uniforms;return e.zoom.value=t,new x.ShaderMaterial({uniforms:e,vertexShader:M.StereographicShader.vertexShader,fragmentShader:M.StereographicShader.fragmentShader})},M.LittlePlanet.prototype.registerMouseEvents=function(){this.container.addEventListener("mousedown",this.onMouseDown.bind(this),!1),this.container.addEventListener("mousemove",this.onMouseMove.bind(this),!1),this.container.addEventListener("mouseup",this.onMouseUp.bind(this),!1),this.container.addEventListener("touchstart",this.onMouseDown.bind(this),!1),this.container.addEventListener("touchmove",this.onMouseMove.bind(this),!1),this.container.addEventListener("touchend",this.onMouseUp.bind(this),!1),this.container.addEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.container.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.container.addEventListener("contextmenu",this.onContextMenu.bind(this),!1)},M.LittlePlanet.prototype.unregisterMouseEvents=function(){this.container.removeEventListener("mousedown",this.onMouseDown.bind(this),!1),this.container.removeEventListener("mousemove",this.onMouseMove.bind(this),!1),this.container.removeEventListener("mouseup",this.onMouseUp.bind(this),!1),this.container.removeEventListener("touchstart",this.onMouseDown.bind(this),!1),this.container.removeEventListener("touchmove",this.onMouseMove.bind(this),!1),this.container.removeEventListener("touchend",this.onMouseUp.bind(this),!1),this.container.removeEventListener("mousewheel",this.onMouseWheel.bind(this),!1),this.container.removeEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1),this.container.removeEventListener("contextmenu",this.onContextMenu.bind(this),!1)},M.LittlePlanet.prototype.onMouseDown=function(t){var e=t.clientX>=0?t.clientX:t.touches[0].clientX,n=t.clientY>=0?t.clientY:t.touches[0].clientY;switch(t.touches&&t.touches.length||1){case 1:this.dragging=!0,this.userMouse.set(e,n);break;case 2:var i=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(i*i+o*o);this.userMouse.pinchDistance=r}this.onUpdateCallback()},M.LittlePlanet.prototype.onMouseMove=function(t){var e=t.clientX>=0?t.clientX:t.touches[0].clientX,n=t.clientY>=0?t.clientY:t.touches[0].clientY;switch(t.touches&&t.touches.length||1){case 1:var i=.4*x.Math.degToRad(e-this.userMouse.x),o=.4*x.Math.degToRad(n-this.userMouse.y);this.dragging&&(this.quatA.setFromAxisAngle(this.vectorY,i),this.quatB.setFromAxisAngle(this.vectorX,o),this.quatCur.multiply(this.quatA).multiply(this.quatB),this.userMouse.set(e,n));break;case 2:var r=(this.material.uniforms,t.touches[0].pageX-t.touches[1].pageX),a=t.touches[0].pageY-t.touches[1].pageY,s=Math.sqrt(r*r+a*a);this.addZoomDelta(this.userMouse.pinchDistance-s)}},M.LittlePlanet.prototype.onMouseUp=function(t){this.dragging=!1},M.LittlePlanet.prototype.onMouseWheel=function(t){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),this.addZoomDelta(e),this.onUpdateCallback()},M.LittlePlanet.prototype.addZoomDelta=function(t){var e=this.material.uniforms,n=.1*this.size,i=10*this.size;e.zoom.value+=t,e.zoom.value<=n?e.zoom.value=n:e.zoom.value>=i&&(e.zoom.value=i)},M.LittlePlanet.prototype.onUpdateCallback=function(){this.frameId=window.requestAnimationFrame(this.onUpdateCallback.bind(this)),this.quatSlerp.slerp(this.quatCur,.1),this.material.uniforms.transform.value.makeRotationFromQuaternion(this.quatSlerp),!this.dragging&&1-this.quatSlerp.clone().dot(this.quatCur)<this.EPS&&window.cancelAnimationFrame(this.frameId)},M.LittlePlanet.prototype.reset=function(){this.quatCur.set(0,0,0,1),this.quatSlerp.set(0,0,0,1),this.onUpdateCallback()},M.LittlePlanet.prototype.onLoad=function(){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight,this.registerMouseEvents(),this.onUpdateCallback(),this.dispatchEvent({type:"panolens-viewer-handler",method:"disableControl"})},M.LittlePlanet.prototype.onLeave=function(){this.unregisterMouseEvents(),this.dispatchEvent({type:"panolens-viewer-handler",method:"enableControl",data:M.Controls.ORBIT}),window.cancelAnimationFrame(this.frameId),M.Panorama.prototype.onLeave.call(this)},M.LittlePlanet.prototype.onWindowResize=function(){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight},M.LittlePlanet.prototype.onContextMenu=function(){this.dragging=!1}}(),function(){M.ImageLittlePlanet=function(t,e,n){M.LittlePlanet.call(this,"image",t,e,n)},M.ImageLittlePlanet.prototype=m()(M.LittlePlanet.prototype),M.ImageLittlePlanet.prototype.constructor=M.ImageLittlePlanet,M.ImageLittlePlanet.prototype.onLoad=function(t){this.updateTexture(t),M.ImagePanorama.prototype.onLoad.call(this,t),M.LittlePlanet.prototype.onLoad.call(this)},M.ImageLittlePlanet.prototype.updateTexture=function(t){t.minFilter=t.magFilter=x.LinearFilter,this.material.uniforms.tDiffuse.value=t}}(),function(){M.Reticle=function(t,e,n,i,o,r){t=t||16777215,this.autoSelect=void 0==e||e,this.dwellTime=o||1500,this.dwellSpriteAmount=r||45,this.dwellInterval=this.dwellTime/this.dwellSpriteAmount,this.IDLE=0,this.DWELLING=1,this.status,this.scaleIdle=new x.Vector3(.2,.2,1),this.scaleDwell=new x.Vector3(1,.8,1),this.textureLoaded=!1,this.idleImageUrl=n||M.DataImage.ReticleIdle,this.dwellImageUrl=i||M.DataImage.ReticleDwell,this.idleTexture=new x.Texture,this.dwellTexture=new x.Texture,x.Sprite.call(this,new x.SpriteMaterial({color:t,depthTest:!1})),this.currentTile=0,this.startTime=0,this.visible=!1,this.renderOrder=10,this.timerId,this.updateStatus(this.IDLE)},M.Reticle.prototype=m()(x.Sprite.prototype),M.Reticle.prototype.constructor=M.Reticle,M.Reticle.prototype.show=function(){this.visible=!0},M.Reticle.prototype.hide=function(){this.visible=!1},M.Reticle.prototype.loadTextures=function(){this.idleTexture=M.Utils.TextureLoader.load(this.idleImageUrl),this.dwellTexture=M.Utils.TextureLoader.load(this.dwellImageUrl),this.material.map=this.idleTexture,this.setupDwellSprite(this.dwellTexture),this.textureLoaded=!0},M.Reticle.prototype.select=function(t){performance.now()-this.startTime>=this.dwellTime?(this.completeDwelling(),t()):this.autoSelect&&(this.updateDwelling(performance.now()),this.timerId=window.requestAnimationFrame(this.select.bind(this,t)))},M.Reticle.prototype.clearTimer=function(){window.cancelAnimationFrame(this.timerId),this.timerId=null},M.Reticle.prototype.setupDwellSprite=function(t){t.wrapS=x.RepeatWrapping,t.repeat.set(1/this.dwellSpriteAmount,1)},M.Reticle.prototype.updateStatus=function(t){this.status=t,t===this.IDLE?(this.scale.copy(this.scaleIdle),this.material.map=this.idleTexture):t===this.DWELLING&&(this.scale.copy(this.scaleDwell),this.material.map=this.dwellTexture),this.currentTile=0,this.material.map.offset.x=0},M.Reticle.prototype.startDwelling=function(t){this.autoSelect&&(this.startTime=performance.now(),this.updateStatus(this.DWELLING),this.select(t))},M.Reticle.prototype.updateDwelling=function(t){var e=t-this.startTime;this.currentTile<=this.dwellSpriteAmount?(this.currentTile=Math.floor(e/this.dwellTime*this.dwellSpriteAmount),this.material.map.offset.x=this.currentTile/this.dwellSpriteAmount):this.updateStatus(this.IDLE)},M.Reticle.prototype.cancelDwelling=function(){this.clearTimer(),this.updateStatus(this.IDLE)},M.Reticle.prototype.completeDwelling=function(){this.clearTimer(),this.updateStatus(this.IDLE)}}(),function(){M.Tile=function(t,e,n,i,o,r,a){this.parameters={width:t,height:e,widthSegments:n,heightSegments:i,forceDirection:o,forceAxis:r,forceAngle:a},t=t||10,e=e||5,n=n||1,i=i||1,o=o||new x.Vector3(0,0,1),r=r||new x.Vector3(0,1,0),a=void 0!==a?a:0,x.Mesh.call(this,new x.PlaneGeometry(t,e,n,i),new x.MeshBasicMaterial({color:16777215,transparent:!0})),this.bendModifier=new x.BendModifier,this.entity=void 0,this.animationDuration=500,this.animationFadeOut=void 0,this.animationFadeIn=void 0,this.animationTranslation=void 0,this.tweens={},0!==a&&this.bend(o,r,a),this.originalGeometry=this.geometry.clone()},M.Tile.prototype=m()(x.Mesh.prototype),M.Tile.prototype.constructor=M.Tile,M.Tile.prototype.clone=function(){var t,e=this.parameters;return t=new M.Tile(e.width,e.height,e.widthSegments,e.heightSegments,e.forceDirection,e.forceAxis,e.forceAngle),t.setEntity(this.entity),t.material=this.material.clone(),t},M.Tile.prototype.bend=function(t,e,n){this.bendModifier.set(t,e,n).modify(this.geometry)},M.Tile.prototype.unbend=function(){var t=this.geometry;this.geometry=this.originalGeometry,this.originalGeometry=this.geometry.clone(),t.dispose(),t=null},M.Tile.prototype.tween=function(t,e,n,i,o,r,a,s,h){return e=e||this,n=n||{},i=i||this.animationDuration,o=o||L.Easing.Exponential.Out,r=void 0!==r?r:0,a=a||null,s=s||null,h=h||null,this.tweens[t]||(this.tweens[t]=new L.Tween(e).to(n,i).easing(o).delay(r).onStart(a).onUpdate(s).onComplete(h)),this.tweens[t]},M.Tile.prototype.ripple=function(t,e,n){t=t||2,e=e||200,n=n||L.Easing.Cubic.Out;var i=this,o=this.clone();new L.Tween(o.scale).to({x:t,y:t},e).easing(n).start(),new L.Tween(o.material).to({opacity:0},e).easing(n).onComplete(function(){i.remove(o),o.geometry.dispose(),o.material.dispose()}).start(),this.add(o)},M.Tile.prototype.setEntity=function(t){this.entity=t}}(),function(){M.TileGroup=function(t,e,n,i,o){var r=this;x.Object3D.call(this),this.tileArray=t||[],this.offset=void 0!==o?o:0,this.v_gap=void 0!==e?e:6,this.d_gap=void 0!==n?n:2,this.animationDuration=void 0!==i?i:200,this.animationEasing=L.Easing.Exponential.Out,this.visibleDelta=2,this.tileArray.map(function(t,e){t.image&&M.Utils.TextureLoader.load(t.image,r.setTexture.bind(t)),t.position.set(0,e*-r.v_gap,e*-r.d_gap),t.originalPosition=t.position.clone(),t.setEntity(r),r.add(t)}),this.updateVisbility()},M.TileGroup.prototype=m()(x.Object3D.prototype),M.TileGroup.prototype.constructor=M.TileGroup,M.TileGroup.prototype.updateTexture=function(t){var e=this;t=t||[],this.children.map(function(n,i){n instanceof M.Tile&&t[i]&&(M.Utils.TextureLoader.load(t[i],e.setTexture.bind(n)),n.outline&&(n.outline.material.visible=!0))})},M.TileGroup.prototype.updateAllTexture=function(t){if(this.updateTexture(t),t.length<this.children.length)for(var e=t.length;e<this.children.length;e++)this.children[e]instanceof M.Tile&&(this.children[e].material.visible=!1,this.children[e].outline&&(this.children[e].outline.material.visible=!1))},M.TileGroup.prototype.setTexture=function(t){t.minFilter=x.LinearFilter,t.magFilter=x.LinearFilter,this.material.visible=!0,this.material.map=t,this.material.needsUpdate=!0},M.TileGroup.prototype.updateVisbility=function(){this.children[this.offset].visible=!0,new L.Tween(this.children[this.offset].material).to({opacity:1},this.animationDuration).easing(this.animationEasing).start(),this.children[this.offset].outline&&(this.children[this.offset].outline.visible=!0);for(var t=this.offset-1;t>=0;t--)-1!==this.tileArray.indexOf(this.children[t])&&(this.offset-t<=this.visibleDelta?(this.children[t].visible=!0,new L.Tween(this.children[t].material).to({opacity:1/(this.offset-t)*.5},this.animationDuration).easing(this.animationEasing).start()):this.children[t].visible=!1,this.children[t].outline&&(this.children[t].outline.visible=!1));for(var t=this.offset+1;t<this.children.length;t++)-1!==this.tileArray.indexOf(this.children[t])&&(t-this.offset<=this.visibleDelta?(this.children[t].visible=!0,new L.Tween(this.children[t].material).to({opacity:1/(t-this.offset)*.5},this.animationDuration).easing(this.animationEasing).start()):this.children[t].visible=!1,this.children[t].outline&&(this.children[t].outline.visible=!1))},M.TileGroup.prototype.scrollUp=function(t){var e,n=this.tileArray;if(t=void 0!==t?t:this.animationDuration,e=this.offset+1,this.offset<n.length-1&&n[this.offset+1].material.visible){for(var i=n.length-1;i>=0;i--)new L.Tween(n[i].position).to({y:(i-e)*-this.v_gap,z:Math.abs(i-e)*-this.d_gap},t).easing(this.animationEasing).start();this.offset++,this.updateVisbility(),this.dispatchEvent({type:"scroll",direction:"up"})}},M.TileGroup.prototype.scrollDown=function(t){var e,n=this.tileArray;if(t=void 0!==t?t:this.animationDuration,e=this.offset-1,this.offset>0&&n[this.offset-1].material.visible){for(var i=0;i<n.length;i++)new L.Tween(n[i].position).to({y:(i-e)*-this.v_gap,z:Math.abs(i-e)*-this.d_gap},t).easing(this.animationEasing).start();this.offset--,this.updateVisbility(),this.dispatchEvent({type:"scroll",direction:"down"})}},M.TileGroup.prototype.reset=function(){this.tileArray.map(function(t,e){t.position.copy(t.originalPosition)}),this.offset=0,this.updateVisbility()},M.TileGroup.prototype.getIndex=function(){return this.offset},M.TileGroup.prototype.getTileCount=function(){var t=0;return this.tileArray.map(function(e){e.material.visible&&t++}),t}}(),function(){var t,e,n=[];M.SpriteText=function(t,e,n,i,o){x.Object3D.call(this),this.text=t||"",this.maxWidth=e||2e3,this.color=n||16777215,this.opacity=void 0!==i?i:1,this.options=o||{},this.animationDuration=500,this.animationFadeOut=void 0,this.animationFadeIn=void 0,this.tweens={},this.addText(t)},M.SpriteText.prototype=m()(x.Object3D.prototype),M.SpriteText.prototype.constructor=M.SpriteText,M.SpriteText.prototype.generateTextGeometry=function(){},M.SpriteText.prototype.generateSDFShader=function(){},M.SpriteText.prototype.setBMFont=function(i,o,r){r.needsUpdate=!0,r.minFilter=x.LinearMipMapLinearFilter,r.magFilter=x.LinearFilter,r.generateMipmaps=!0,r.anisotropy=8,t=o,e=r;for(var a=n.length-1;a>=0;a--)n[a].target.addText(n[a].text);for(;n.length>0;)n.pop();i&&i()},M.SpriteText.prototype.addText=function(i){if(!t||!e)return void n.push({target:this,text:i});var o=new x.Object3D;this.options.text=i,this.options.font=t,this.options.width=this.maxWidth;var r=this.generateTextGeometry(this.options);r.computeBoundingBox(),r.computeBoundingSphere();var a=new x.RawShaderMaterial(this.generateSDFShader({map:e,side:x.DoubleSide,transparent:!0,color:this.color,opacity:this.opacity})),s=r.layout,h=new x.Mesh(r,a);h.entity=this,h.position.x=-s.width/2,h.position.y=1.035*s.height,o.scale.x=o.scale.y=-.05,o.add(h),this.mesh=h,this.add(o)},M.SpriteText.prototype.update=function(t){var e;t=t||{},e=this.mesh,e.geometry.update(t),e.position.x=-e.geometry.layout.width/2,e.position.y=1.035*e.geometry.layout.height},M.SpriteText.prototype.tween=function(t,e,n,i,o,r,a,s,h){return e=e||this,n=n||{},i=i||this.animationDuration,o=o||L.Easing.Exponential.Out,r=void 0!==r?r:0,a=a||null,s=s||null,h=h||null,this.tweens[t]||(this.tweens[t]=new L.Tween(e).to(n,i).easing(o).delay(r).onStart(a).onUpdate(s).onComplete(h)),this.tweens[t]},M.SpriteText.prototype.getLayout=function(){return this.mesh&&this.mesh.geometry&&this.mesh.geometry.layout||{}},M.SpriteText.prototype.setEntity=function(t){this.entity=t}}(),function(){M.Widget=function(t){x.EventDispatcher.call(this),this.DEFAULT_TRANSITION="all 0.27s ease",this.TOUCH_ENABLED=M.Utils.checkTouchSupported(),this.PREVENT_EVENT_HANDLER=function(t){t.preventDefault(),t.stopPropagation()},this.container=t,this.barElement,this.fullscreenElement,this.videoElement,this.settingElement,this.mainMenu,this.activeMainItem,this.activeSubMenu,this.mask},M.Widget.prototype=m()(x.EventDispatcher.prototype),M.Widget.prototype.constructor=M.Widget,M.Widget.prototype.addControlBar=function(){if(!this.container)return void console.warn("Widget container not set");var t,e,n,i,o=this;i="linear-gradient(bottom, rgba(0,0,0,0.2), rgba(0,0,0,0))",t=document.createElement("div"),t.style.width="100%",t.style.height="44px",t.style.float="left",t.style.transform=t.style.webkitTransform=t.style.msTransform="translateY(-100%)",t.style.background="-webkit-"+i,t.style.background="-moz-"+i,t.style.background="-o-"+i,t.style.background="-ms-"+i,t.style.background=i,t.style.transition=this.DEFAULT_TRANSITION,t.style.pointerEvents="none",t.isHidden=!1,t.toggle=function(){t.isHidden=!t.isHidden,e=t.isHidden?"translateY(0)":"translateY(-100%)",n=t.isHidden?0:1,t.style.transform=t.style.webkitTransform=t.style.msTransform=e,t.style.opacity=n};var r=this.createDefaultMenu();this.mainMenu=this.createMainMenu(r),t.appendChild(this.mainMenu);var a=this.createMask();this.mask=a,this.container.appendChild(a),t.dispose=function(){o.fullscreenElement&&(t.removeChild(o.fullscreenElement),o.fullscreenElement.dispose(),o.fullscreenElement=null),o.settingElement&&(t.removeChild(o.settingElement),o.settingElement.dispose(),o.settingElement=null),o.videoElement&&(t.removeChild(o.videoElement),o.videoElement.dispose(),o.videoElement=null)},this.container.appendChild(t),this.mask.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),this.mask.addEventListener(o.TOUCH_ENABLED?"touchend":"click",function(t){t.preventDefault(),t.stopPropagation(),o.mask.hide(),o.settingElement.deactivate()},!1),this.addEventListener("control-bar-toggle",t.toggle),this.barElement=t},M.Widget.prototype.createDefaultMenu=function(){var t,e=this;return t=function(t,n){return function(){e.dispatchEvent({type:"panolens-viewer-handler",method:t,data:n})}},[{title:"Control",subMenu:[{title:this.TOUCH_ENABLED?"Touch":"Mouse",handler:t("enableControl",M.Controls.ORBIT)},{title:"Sensor",handler:t("enableControl",M.Controls.DEVICEORIENTATION)}]},{title:"Mode",subMenu:[{title:"Normal",handler:t("disableEffect")},{title:"Cardboard",handler:t("enableEffect",M.Modes.CARDBOARD)},{title:"Stereoscopic",handler:t("enableEffect",M.Modes.STEREO)}]}]},M.Widget.prototype.addControlButton=function(t){var e;switch(t){case"fullscreen":e=this.createFullscreenButton(),this.fullscreenElement=e;break;case"setting":e=this.createSettingButton(),this.settingElement=e;break;case"video":e=this.createVideoControl(),this.videoElement=e;break;default:return}e&&this.barElement.appendChild(e)},M.Widget.prototype.createMask=function(){var t=document.createElement("div");return t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.width="100%",t.style.height="100%",t.style.background="transparent",t.style.display="none",t.show=function(){this.style.display="block"},t.hide=function(){this.style.display="none"},t},M.Widget.prototype.createSettingButton=function(){function t(t){t.preventDefault(),t.stopPropagation(),n.mainMenu.toggle(),this.activated?this.deactivate():this.activate()}var e,n=this;return e=this.createCustomItem({style:{backgroundImage:'url("'+M.DataImage.Setting+'")',webkitTransition:this.DEFAULT_TRANSITION,transition:this.DEFAULT_TRANSITION},onTap:t}),e.activate=function(){this.style.transform="rotate3d(0,0,1,90deg)",this.activated=!0,n.mask.show()},e.deactivate=function(){this.style.transform="rotate3d(0,0,0,0)",this.activated=!1,n.mask.hide(),n.mainMenu&&n.mainMenu.visible&&n.mainMenu.hide(),n.activeSubMenu&&n.activeSubMenu.visible&&n.activeSubMenu.hide(),n.mainMenu&&n.mainMenu._width&&(n.mainMenu.changeSize(n.mainMenu._width),n.mainMenu.unslideAll())},e.activated=!1,e},M.Widget.prototype.createFullscreenButton=function(){function t(t){t.preventDefault(),t.stopPropagation(),a=!1,r?(document.exitFullscreen&&document.exitFullscreen(),document.msExitFullscreen&&document.msExitFullscreen(),document.mozCancelFullScreen&&document.mozCancelFullScreen(),document.webkitExitFullscreen&&document.webkitExitFullscreen(),r=!1):(o.container.requestFullscreen&&o.container.requestFullscreen(),o.container.msRequestFullscreen&&o.container.msRequestFullscreen(),o.container.mozRequestFullScreen&&o.container.mozRequestFullScreen(),o.container.webkitRequestFullscreen&&o.container.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),r=!0),this.style.backgroundImage=r?'url("'+M.DataImage.FullscreenLeave+'")':'url("'+M.DataImage.FullscreenEnter+'")'}function e(t){a&&(r=!r,n.style.backgroundImage=r?'url("'+M.DataImage.FullscreenLeave+'")':'url("'+M.DataImage.FullscreenEnter+'")'),o.dispatchEvent({type:"panolens-viewer-handler",method:"onWindowResize",data:!1}),a=!0}var n,i,o=this,r=!1,a=!0;if(i="panolens-style-addon",document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){if(document.addEventListener("fullscreenchange",e,!1),document.addEventListener("webkitfullscreenchange",e,!1),document.addEventListener("mozfullscreenchange",e,!1),document.addEventListener("MSFullscreenChange",e,!1),n=this.createCustomItem({style:{backgroundImage:'url("'+M.DataImage.FullscreenEnter+'")'},onTap:t}),!document.querySelector(i)){var s=document.createElement("style");s.id=i,s.innerHTML=":-webkit-full-screen { width: 100% !important; height: 100% !important }",document.body.appendChild(s)}return n}},M.Widget.prototype.createVideoControl=function(){var t;return t=document.createElement("span"),t.style.display="none",t.show=function(){t.style.display=""},t.hide=function(){t.style.display="none",t.controlButton.paused=!0,t.controlButton.update()},t.controlButton=this.createVideoControlButton(),t.seekBar=this.createVideoControlSeekbar(),t.appendChild(t.controlButton),t.appendChild(t.seekBar),t.dispose=function(){t.removeChild(t.controlButton),t.removeChild(t.seekBar),t.controlButton.dispose(),t.controlButton=null,t.seekBar.dispose(),t.seekBar=null},this.addEventListener("video-control-show",t.show),this.addEventListener("video-control-hide",t.hide),t},M.Widget.prototype.createVideoControlButton=function(){function t(t){t.preventDefault(),t.stopPropagation(),n.dispatchEvent({type:"panolens-viewer-handler",method:"toggleVideoPlay",data:!this.paused}),this.paused=!this.paused,e.update()}var e,n=this;return e=this.createCustomItem({style:{float:"left",backgroundImage:'url("'+M.DataImage.VideoPlay+'")'},onTap:t}),e.paused=!0,e.update=function(t){this.paused=void 0!==t?t:this.paused,this.style.backgroundImage='url("'+(this.paused?M.DataImage.VideoPlay:M.DataImage.VideoPause)+'")'},e},M.Widget.prototype.createVideoControlSeekbar=function(){function t(t){t.stopPropagation(),f=!0,l=t.clientX||t.changedTouches&&t.changedTouches[0].clientX,d=parseInt(h.style.width)/100,i()}function e(t){var e;f&&(e=t.clientX||t.changedTouches&&t.changedTouches[0].clientX,u=(e-l)/s.clientWidth,u=d+u,u=u>1?1:u<0?0:u,s.setProgress(u),p.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:u}))}function n(t){t.stopPropagation(),f=!1,o()}function i(){p.container.addEventListener("mousemove",e,!1),p.container.addEventListener("mouseup",n,!1),p.container.addEventListener("touchmove",e,!1),p.container.addEventListener("touchend",n,!1)}function o(){p.container.removeEventListener("mousemove",e,!1),p.container.removeEventListener("mouseup",n,!1),p.container.removeEventListener("touchmove",e,!1),p.container.removeEventListener("touchend",n,!1)}function r(t){t.preventDefault(),t.stopPropagation();var e;t.target!==c&&(e=t.changedTouches&&t.changedTouches.length>0?(t.changedTouches[0].pageX-t.target.getBoundingClientRect().left)/this.clientWidth:t.offsetX/this.clientWidth,p.dispatchEvent({type:"panolens-viewer-handler",method:"setVideoCurrentTime",data:e}),s.setProgress(t.offsetX/this.clientWidth))}function a(){o(),h=null,c=null}var s,h,c,l,d,u,p=this,f=!1;return h=document.createElement("div"),h.style.width="0%",h.style.height="100%",h.style.backgroundColor="#fff",c=document.createElement("div"),c.style.float="right",c.style.width="14px",c.style.height="14px",c.style.transform="translate(7px, -5px)",c.style.borderRadius="50%",c.style.backgroundColor="#ddd",c.addEventListener("mousedown",t,!1),c.addEventListener("touchstart",t,!1),h.appendChild(c),s=this.createCustomItem({style:{float:"left",width:"30%",height:"4px",marginTop:"20px",backgroundColor:"rgba(188,188,188,0.8)"},onTap:r,onDispose:a}),s.appendChild(h),s.setProgress=function(t){h.style.width=100*t+"%"},this.addEventListener("video-update",function(t){s.setProgress(t.percentage)}),s},M.Widget.prototype.createMenuItem=function(t){var e=this,n=document.createElement("a");return n.textContent=t,n.style.display="block",n.style.padding="10px",n.style.textDecoration="none",n.style.cursor="pointer",n.style.pointerEvents="auto",n.style.transition=this.DEFAULT_TRANSITION,n.slide=function(t){this.style.transform="translateX("+(t?"":"-")+"100%)"},n.unslide=function(){this.style.transform="translateX(0)"},n.setIcon=function(t){this.icon&&(this.icon.style.backgroundImage="url("+t+")")},n.setSelectionTitle=function(t){this.selection&&(this.selection.textContent=t)},n.addSelection=function(t){var e=document.createElement("span");return e.style.fontSize="13px",e.style.fontWeight="300",e.style.float="right",this.selection=e,this.setSelectionTitle(t),this.appendChild(e),this},n.addIcon=function(t,e,n){t=t||M.DataImage.ChevronRight,e=e||!1,n=n||!1;var i=document.createElement("span");return i.style.float=e?"left":"right",i.style.width="17px",i.style.height="17px",i.style["margin"+(e?"Right":"Left")]="12px",i.style.backgroundSize="cover",n&&(i.style.transform="rotateZ(180deg)"),this.icon=i,this.setIcon(t),this.appendChild(i),this},n.addSubMenu=function(t,n){return this.subMenu=e.createSubMenu(t,n),this},n.addEventListener("mouseenter",function(){this.style.backgroundColor="#e0e0e0"},!1),n.addEventListener("mouseleave",function(){this.style.backgroundColor="#fafafa"},!1),n},M.Widget.prototype.createMenuItemHeader=function(t){var e=this.createMenuItem(t);return e.style.borderBottom="1px solid #333",e.style.paddingBottom="15px",e},M.Widget.prototype.createMainMenu=function(t){function e(t){function e(){i.changeSize(o.clientWidth),o.show(),o.unslideAll()}t.preventDefault(),t.stopPropagation();var i=n.mainMenu,o=this.subMenu;i.hide(),i.slideAll(),i.parentElement.appendChild(o),n.activeMainItem=this,n.activeSubMenu=o,window.requestAnimationFrame(e)}var n=this,i=this.createMenu();i._width=200,i.changeSize(i._width);for(var o=0;o<t.length;o++){var r=i.addItem(t[o].title);if(r.style.paddingLeft="20px",r.addIcon().addEventListener(n.TOUCH_ENABLED?"touchend":"click",e,!1),t[o].subMenu&&t[o].subMenu.length>0){var a=t[o].subMenu[0].title;r.addSelection(a).addSubMenu(t[o].title,t[o].subMenu)}}return i},M.Widget.prototype.createSubMenu=function(t,e){function n(t){t.preventDefault(),t.stopPropagation(),i=o.mainMenu,i.changeSize(i._width),i.unslideAll(),i.show(),r.slideAll(!0),r.hide(),"header"!==this.type&&(r.setActiveItem(this),o.activeMainItem.setSelectionTitle(this.textContent),this.handler&&this.handler())}var i,o=this,r=this.createMenu();r.items=e,r.activeItem,r.addHeader(t).addIcon(void 0,!0,!0).addEventListener(o.TOUCH_ENABLED?"touchend":"click",n,!1);for(var a=0;a<e.length;a++){var s=r.addItem(e[a].title);s.style.fontWeight=300,s.handler=e[a].handler,s.addIcon(" ",!0),s.addEventListener(o.TOUCH_ENABLED?"touchend":"click",n,!1),r.activeItem||r.setActiveItem(s)}return r.slideAll(!0),r},M.Widget.prototype.createMenu=function(){var t,e=this,n=document.createElement("span");return t=n.style,t.padding="5px 0",t.position="fixed",t.bottom="100%",t.right="14px",t.backgroundColor="#fafafa",t.fontFamily="Helvetica Neue",t.fontSize="14px",t.visibility="hidden",t.opacity=0,t.boxShadow="0 0 12pt rgba(0,0,0,0.25)",t.borderRadius="2px",t.overflow="hidden",t.willChange="width, height, opacity",t.pointerEvents="auto",t.transition=this.DEFAULT_TRANSITION,n.visible=!1,n.changeSize=function(t,e){t&&(this.style.width=t+"px"),e&&(this.style.height=e+"px")},n.show=function(){this.style.opacity=1,this.style.visibility="visible",this.visible=!0},n.hide=function(){this.style.opacity=0,this.style.visibility="hidden",this.visible=!1},n.toggle=function(){this.visible?this.hide():this.show()},n.slideAll=function(t){for(var e=0;e<n.children.length;e++)n.children[e].slide&&n.children[e].slide(t)},n.unslideAll=function(){for(var t=0;t<n.children.length;t++)n.children[t].unslide&&n.children[t].unslide()},n.addHeader=function(t){var n=e.createMenuItemHeader(t);return n.type="header",this.appendChild(n),n},n.addItem=function(t){var n=e.createMenuItem(t);return n.type="item",this.appendChild(n),n},n.setActiveItem=function(t){this.activeItem&&this.activeItem.setIcon(" "),t.setIcon(M.DataImage.Check),this.activeItem=t},n.addEventListener("mousemove",this.PREVENT_EVENT_HANDLER,!0),n.addEventListener("mouseup",this.PREVENT_EVENT_HANDLER,!0),n.addEventListener("mousedown",this.PREVENT_EVENT_HANDLER,!0),n},M.Widget.prototype.createCustomItem=function(t){t=t||{};var e=this,n=t.element||document.createElement("span");return n.style.cursor="pointer",n.style.float="right",n.style.width="44px",n.style.height="100%",n.style.backgroundSize="60%",n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="center",n.style.webkitUserSelect=n.style.MozUserSelect=n.style.userSelect="none",n.style.position="relative",n.style.pointerEvents="auto",n.addEventListener(e.TOUCH_ENABLED?"touchstart":"mouseenter",function(){n.style.filter=n.style.webkitFilter="drop-shadow(0 0 5px rgba(255,255,255,1))"}),n.addEventListener(e.TOUCH_ENABLED?"touchend":"mouseleave",function(){n.style.filter=n.style.webkitFilter=""}),n=this.mergeStyleOptions(n,t.style),t.onTap&&n.addEventListener(e.TOUCH_ENABLED?"touchend":"click",t.onTap,!1),n.dispose=function(){n.removeEventListener(e.TOUCH_ENABLED?"touchend":"click",t.onTap,!1),t.onDispose&&t.onDispose()},n},M.Widget.prototype.mergeStyleOptions=function(t,e){e=e||{};for(var n in e)e.hasOwnProperty(n)&&(t.style[n]=e[n]);return t},M.Widget.prototype.dispose=function(){this.barElement&&(this.container.removeChild(this.barElement),this.barElement.dispose(),this.barElement=null)}}(),function(){M.Infospot=function(t,e,n){function i(e){e.wrapS=x.RepeatWrapping,e.repeat.x=-1,e.image.width=e.image.naturalWidth||64,e.image.height=e.image.naturalHeight||64,a=e.image.width/e.image.height,c.scale.set(a*t,t,1),s=c.scale.clone(),c.scaleUpAnimation=new L.Tween(c.scale).to({x:s.x*c.scaleFactor,y:s.y*c.scaleFactor},h).easing(L.Easing.Elastic.Out),c.scaleDownAnimation=new L.Tween(c.scale).to({x:s.x,y:s.y},h).easing(L.Easing.Elastic.Out),c.material.side=x.DoubleSide,c.material.map=e,c.material.depthTest=!1,c.material.needsUpdate=!0}function o(){this.visible=!0}function r(){this.visible=!1}var a,s,h,c=this;t=t||300,e=e||M.DataImage.Info,h=500,x.Sprite.call(this),this.type="infospot",this.animated=void 0===n||n,this.isHovering=!1,this.visible=!1,this.element,this.toPanorama,this.cursorStyle,this.mode=M.Modes.UNKNOWN,this.scale.set(t,t,1),this.rotation.y=Math.PI,this.scaleFactor=1.3,this.container,this.HANDLER_FOCUS,M.Utils.TextureLoader.load(e,i),this.showAnimation=new L.Tween(this.material).to({opacity:1},h).onStart(o.bind(this)).easing(L.Easing.Quartic.Out),this.hideAnimation=new L.Tween(this.material).to({opacity:0},h).onComplete(r.bind(this)).easing(L.Easing.Quartic.Out),this.addEventListener("click",this.onClick),this.addEventListener("hover",this.onHover),this.addEventListener("hoverenter",this.onHoverStart),this.addEventListener("hoverleave",this.onHoverEnd),this.addEventListener("panolens-dual-eye-effect",this.onDualEyeEffect),this.addEventListener("panolens-container",this.setContainer.bind(this)),this.addEventListener("dismiss",this.onDismiss),this.addEventListener("panolens-infospot-focus",this.setFocusMethod)},M.Infospot.prototype=m()(x.Sprite.prototype),M.Infospot.prototype.setContainer=function(t){var e;t instanceof HTMLElement?e=t:t&&t.container&&(e=t.container),e&&this.element&&e.appendChild(this.element),this.container=e},M.Infospot.prototype.getContainer=function(){return this.container},M.Infospot.prototype.onClick=function(t){this.element&&this.getContainer()&&(this.onHoverStart(t),this.lockHoverElement())},M.Infospot.prototype.onDismiss=function(t){this.element&&(this.unlockHoverElement(),this.onHoverEnd())},M.Infospot.prototype.onHover=function(t){},M.Infospot.prototype.onHoverStart=function(t){if(this.getContainer()){var e=this.cursorStyle||(this.mode===M.Modes.NORMAL?"pointer":"default");this.isHovering=!0,this.container.style.cursor=e,this.animated&&(this.scaleDownAnimation&&this.scaleDownAnimation.stop(),this.scaleUpAnimation&&this.scaleUpAnimation.start()),this.element&&t.mouseEvent.clientX>=0&&t.mouseEvent.clientY>=0&&(this.mode===M.Modes.CARDBOARD||this.mode===M.Modes.STEREO?(this.element.style.display="none",this.element.left&&(this.element.left.style.display="block"),this.element.right&&(this.element.right.style.display="block"),this.element._width=this.element.left.clientWidth,this.element._height=this.element.left.clientHeight):(this.element.style.display="block",this.element.left&&(this.element.left.style.display="none"),this.element.right&&(this.element.right.style.display="none"),this.element._width=this.element.clientWidth,this.element._height=this.element.clientHeight))}},M.Infospot.prototype.onHoverEnd=function(){this.getContainer()&&(this.isHovering=!1,this.container.style.cursor="default",this.animated&&(this.scaleUpAnimation&&this.scaleUpAnimation.stop(),this.scaleDownAnimation&&this.scaleDownAnimation.start()),this.element&&!this.element.locked&&(this.element.style.display="none",this.element.left&&(this.element.left.style.display="none"),this.element.right&&(this.element.right.style.display="none"),this.unlockHoverElement()))},M.Infospot.prototype.onDualEyeEffect=function(t){if(this.getContainer()){var e,n,i;this.mode=t.mode,e=this.element,n=this.container.clientWidth/2,i=this.container.clientHeight/2,e&&(e.left&&e.right||(e.left=e.cloneNode(!0),e.right=e.cloneNode(!0)),this.mode===M.Modes.CARDBOARD||this.mode===M.Modes.STEREO?(e.left.style.display=e.style.display,e.right.style.display=e.style.display,e.style.display="none"):(e.style.display=e.left.style.display,e.left.style.display="none",e.right.style.display="none"),this.translateElement(n,i),this.container.appendChild(e.left),this.container.appendChild(e.right))}},M.Infospot.prototype.translateElement=function(t,e){if(this.element._width&&this.element._height&&this.getContainer()){var n,i,o,r,a,s,h;h=this.container,o=this.element,r=o._width/2,a=o._height/2,s=void 0!==o.verticalDelta?o.verticalDelta:40,n=t-r,i=e-a-s,this.mode!==M.Modes.CARDBOARD&&this.mode!==M.Modes.STEREO||!o.left||!o.right||t===h.clientWidth/2&&e===h.clientHeight/2?this.setElementStyle("transform",o,"translate("+n+"px, "+i+"px)"):(n=h.clientWidth/4-r+(t-h.clientWidth/2),i=h.clientHeight/2-a-s+(e-h.clientHeight/2),this.setElementStyle("transform",o.left,"translate("+n+"px, "+i+"px)"),n+=h.clientWidth/2,this.setElementStyle("transform",o.right,"translate("+n+"px, "+i+"px)"))}},M.Infospot.prototype.setElementStyle=function(t,e,n){var i=e.style;"transform"===t&&(i.webkitTransform=i.msTransform=i.transform=n)},M.Infospot.prototype.setText=function(t){this.element&&(this.element.textContent=t)},M.Infospot.prototype.setCursorHoverStyle=function(t){this.cursorStyle=t},M.Infospot.prototype.addHoverText=function(t,e){this.element||(this.element=document.createElement("div"),this.element.style.display="none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",this.element.style.fontFamily='"Trebuchet MS", Helvetica, sans-serif',this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=void 0!==e?e:40),this.setText(t)},M.Infospot.prototype.addHoverElement=function(t,e){this.element||(this.element=t.cloneNode(!0),this.element.style.display="none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=void 0!==e?e:40)},M.Infospot.prototype.removeHoverElement=function(){this.element&&(this.element.left&&(this.container.removeChild(this.element.left),this.element.left=null),this.element.right&&(this.container.removeChild(this.element.right),this.element.right=null),this.container.removeChild(this.element),this.element=null)},M.Infospot.prototype.lockHoverElement=function(){this.element&&(this.element.locked=!0)},M.Infospot.prototype.unlockHoverElement=function(){this.element&&(this.element.locked=!1)},M.Infospot.prototype.show=function(t){t=t||0,this.animated&&(this.hideAnimation&&this.hideAnimation.stop(),this.showAnimation&&this.showAnimation.delay(t).start())},M.Infospot.prototype.hide=function(t){t=t||0,this.animated&&(this.showAnimation&&this.showAnimation.stop(),this.hideAnimation&&this.hideAnimation.delay(t).start())},M.Infospot.prototype.setFocusMethod=function(t){t&&(this.HANDLER_FOCUS=t.method)},M.Infospot.prototype.focus=function(t,e){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,t,e),this.onDismiss())},M.Infospot.prototype.dispose=function(){this.removeHoverElement(),this.material.dispose(),this.parent&&this.parent.remove(this)}}(),function(){M.Viewer=function(t){if(x.EventDispatcher.call(this),!x)return void console.error("Three.JS not found");var e;t=t||{},t.controlBar=void 0===t.controlBar||t.controlBar,t.controlButtons=t.controlButtons||["fullscreen","setting","video"],t.autoHideControlBar=void 0!==t.autoHideControlBar&&t.autoHideControlBar,t.autoHideInfospot=void 0===t.autoHideInfospot||t.autoHideInfospot,t.horizontalView=void 0!==t.horizontalView&&t.horizontalView,t.clickTolerance=t.clickTolerance||10,t.cameraFov=t.cameraFov||60,t.reverseDragging=t.reverseDragging||!1,t.enableReticle=t.enableReticle||!1,t.dwellTime=t.dwellTime||1500,t.autoReticleSelect=void 0===t.autoReticleSelect||t.autoReticleSelect,t.viewIndicator=void 0!==t.viewIndicator&&t.viewIndicator,t.indicatorSize=t.indicatorSize||30,t.output=t.output?t.output:"none",this.options=t,t.container?(e=t.container,e._width=e.clientWidth,e._height=e.clientHeight):(e=document.createElement("div"),e.classList.add("panolens-container"),e.style.width="100%",e.style.height="100%",e._width=window.innerWidth,e._height=window.innerHeight,document.body.appendChild(e)),this.container=e,this.camera=t.camera||new x.PerspectiveCamera(this.options.cameraFov,this.container.clientWidth/this.container.clientHeight,1,1e4),this.scene=t.scene||new x.Scene,this.renderer=t.renderer||new x.WebGLRenderer({alpha:!0,antialias:!1}),this.viewIndicatorSize=t.indicatorSize,this.reticle={},this.tempEnableReticle=this.options.enableReticle,this.mode=M.Modes.NORMAL,this.OrbitControls,this.DeviceOrientationControls,this.CardboardEffect,this.StereoEffect,this.controls,this.effect,this.panorama,this.widget,this.hoverObject,this.infospot,this.pressEntityObject,this.pressObject,this.raycaster=new x.Raycaster,this.raycasterPoint=new x.Vector2,this.userMouse=new x.Vector2,this.updateCallbacks=[],this.requestAnimationId,this.cameraFrustum=new x.Frustum,this.cameraViewProjectionMatrix=new x.Matrix4,this.outputDivElement,this.HANDLER_MOUSE_DOWN=this.onMouseDown.bind(this),this.HANDLER_MOUSE_UP=this.onMouseUp.bind(this),this.HANDLER_MOUSE_MOVE=this.onMouseMove.bind(this),this.HANDLER_WINDOW_RESIZE=this.onWindowResize.bind(this),this.HANDLER_KEY_DOWN=this.onKeyDown.bind(this),this.HANDLER_KEY_UP=this.onKeyUp.bind(this),this.HANDLER_TAP=this.onTap.bind(this,{clientX:this.container.clientWidth/2,clientY:this.container.clientHeight/2}),this.OUTPUT_INFOSPOT=!1,this.tweenLeftAnimation=new L.Tween,this.tweenUpAnimation=new L.Tween,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setClearColor(0,1),this.renderer.sortObjects=!1,this.renderer.domElement.classList.add("panolens-canvas"),this.renderer.domElement.style.display="block",this.container.style.backgroundColor="#000",this.container.appendChild(this.renderer.domElement),this.OrbitControls=new x.OrbitControls(this.camera,this.container),this.OrbitControls.name="orbit",this.OrbitControls.minDistance=1,this.OrbitControls.noPan=!0,this.DeviceOrientationControls=new x.DeviceOrientationControls(this.camera,this.container),this.DeviceOrientationControls.name="device-orientation",this.DeviceOrientationControls.enabled=!1,this.camera.position.z=1,this.options.passiveRendering&&console.warn("passiveRendering is now deprecated"),this.controls=[this.OrbitControls,this.DeviceOrientationControls],this.control=this.OrbitControls,this.CardboardEffect=new x.CardboardEffect(this.renderer),this.CardboardEffect.setSize(this.container.clientWidth,this.container.clientHeight),this.StereoEffect=new x.StereoEffect(this.renderer),this.StereoEffect.setSize(this.container.clientWidth,this.container.clientHeight),this.effect=this.CardboardEffect,this.addReticle(),this.options.horizontalView&&(this.OrbitControls.minPolarAngle=Math.PI/2,this.OrbitControls.maxPolarAngle=Math.PI/2),!1!==this.options.controlBar&&this.addDefaultControlBar(this.options.controlButtons),this.options.viewIndicator&&this.addViewIndicator(),this.options.reverseDragging&&this.reverseDraggingDirection(),this.options.enableReticle?this.enableReticleControl():this.registerMouseAndTouchEvents(),"overlay"===this.options.output&&this.addOutputElement(),this.registerEventListeners(),this.animate.call(this)},M.Viewer.prototype=m()(x.EventDispatcher.prototype),M.Viewer.prototype.constructor=M.Viewer,M.Viewer.prototype.add=function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}this.scene.add(t),t.addEventListener&&t.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),t instanceof M.Panorama&&t.dispatchEvent&&t.dispatchEvent({type:"panolens-container",container:this.container}),"panorama"===t.type&&(this.addPanoramaEventListener(t),this.panorama||this.setPanorama(t))},M.Viewer.prototype.remove=function(t){t.removeEventListener&&t.removeEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),this.scene.remove(t)},M.Viewer.prototype.addDefaultControlBar=function(t){var e=this;if(this.widget)return void console.warn("Default control bar exists");this.widget=new M.Widget(this.container),this.widget.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this)),this.widget.addControlBar(),t.forEach(function(t){e.widget.addControlButton(t)})},M.Viewer.prototype.setPanorama=function(t){var e=this.panorama;if("panorama"===t.type&&e!==t){this.hideInfospot();var n=function n(){e&&e.onLeave(),t.removeEventListener("enter-fade-start",n)};t.addEventListener("enter-fade-start",n),(this.panorama=t).onEnter()}},M.Viewer.prototype.eventHandler=function(t){t.method&&this[t.method]&&this[t.method](t.data)},M.Viewer.prototype.dispatchEventToChildren=function(t){this.scene.traverse(function(e){e.dispatchEvent&&e.dispatchEvent(t)})},M.Viewer.prototype.activateWidgetItem=function(t,e){var n,i=this.widget.mainMenu,o=i.children[0],r=i.children[1];if(void 0!==t){switch(t){case 0:n=o.subMenu.children[1];break;case 1:n=o.subMenu.children[2];break;default:n=o.subMenu.children[1]}o.subMenu.setActiveItem(n),o.setSelectionTitle(n.textContent)}if(void 0!==e){switch(e){case M.Modes.CARDBOARD:n=r.subMenu.children[2];break;case M.Modes.STEREO:n=r.subMenu.children[3];break;default:n=r.subMenu.children[1]}r.subMenu.setActiveItem(n),r.setSelectionTitle(n.textContent)}},M.Viewer.prototype.enableEffect=function(t){if(this.mode!==t){if(t===M.Modes.NORMAL)return void this.disableEffect();this.mode=t;var e=this.camera.fov;switch(t){case M.Modes.CARDBOARD:this.effect=this.CardboardEffect,this.enableReticleControl();break;case M.Modes.STEREO:this.effect=this.StereoEffect,this.enableReticleControl();break;default:this.effect=null,this.disableReticleControl()}this.activateWidgetItem(void 0,this.mode),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.camera.fov=e+.01,this.effect.setSize(this.container.clientWidth,this.container.clientHeight),this.render(),this.camera.fov=e}},M.Viewer.prototype.disableEffect=function(){this.mode!==M.Modes.NORMAL&&(this.mode=M.Modes.NORMAL,this.disableReticleControl(),this.activateWidgetItem(void 0,this.mode),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.render())},M.Viewer.prototype.enableReticleControl=function(){this.reticle.visible||(this.reticle.textureLoaded||this.reticle.loadTextures(),this.tempEnableReticle=!0,this.unregisterMouseAndTouchEvents(),this.reticle.show(),this.registerReticleEvent(),this.updateReticleEvent())},M.Viewer.prototype.disableReticleControl=function(){this.tempEnableReticle=!1,this.options.enableReticle?this.updateReticleEvent():(this.reticle.hide(),this.unregisterReticleEvent(),this.registerMouseAndTouchEvents())},M.Viewer.prototype.toggleVideoPlay=function(t){this.panorama instanceof M.VideoPanorama&&this.panorama.dispatchEvent({type:"video-toggle",pause:t})},M.Viewer.prototype.setVideoCurrentTime=function(t){this.panorama instanceof M.VideoPanorama&&this.panorama.dispatchEvent({type:"video-time",percentage:t})},M.Viewer.prototype.onVideoUpdate=function(t){this.widget&&this.widget.dispatchEvent({type:"video-update",percentage:t})},M.Viewer.prototype.addUpdateCallback=function(t){t&&this.updateCallbacks.push(t)},M.Viewer.prototype.removeUpdateCallback=function(t){var e=this.updateCallbacks.indexOf(t);t&&e>=0&&this.updateCallbacks.splice(e,1)},M.Viewer.prototype.showVideoWidget=function(){this.widget&&this.widget.dispatchEvent({type:"video-control-show"})},M.Viewer.prototype.hideVideoWidget=function(){this.widget&&this.widget.dispatchEvent({type:"video-control-hide"})},M.Viewer.prototype.updateVideoPlayButton=function(t){this.widget&&this.widget.videoElement&&this.widget.videoElement.controlButton&&this.widget.videoElement.controlButton.update(t)},M.Viewer.prototype.addPanoramaEventListener=function(t){t.addEventListener("enter-fade-start",this.setCameraControl.bind(this)),t instanceof M.VideoPanorama&&(t.addEventListener("enter-fade-start",this.showVideoWidget.bind(this)),t.addEventListener("leave",function(){this.panorama instanceof M.VideoPanorama||this.hideVideoWidget.call(this)}.bind(this)))},M.Viewer.prototype.setCameraControl=function(){this.OrbitControls.target.copy(this.panorama.position)},M.Viewer.prototype.getControl=function(){return this.control},M.Viewer.prototype.getScene=function(){return this.scene},M.Viewer.prototype.getCamera=function(){return this.camera},M.Viewer.prototype.getRenderer=function(){return this.renderer},M.Viewer.prototype.getContainer=function(){return this.container},M.Viewer.prototype.getControlName=function(){return this.control.name},M.Viewer.prototype.getNextControlName=function(){return this.controls[this.getNextControlIndex()].name},M.Viewer.prototype.getNextControlIndex=function(){var t,e,n;return t=this.controls,e=this.control,n=t.indexOf(e)+1,n>=t.length?0:n},M.Viewer.prototype.setCameraFov=function(t){this.camera.fov=t,this.camera.updateProjectionMatrix()},M.Viewer.prototype.enableControl=function(t){switch(t=t>=0&&t<this.controls.length?t:0,this.control.enabled=!1,this.control=this.controls[t],this.control.enabled=!0,t){case M.Controls.ORBIT:this.camera.position.copy(this.panorama.position),this.camera.position.z+=1;break;case M.Controls.DEVICEORIENTATION:this.camera.position.copy(this.panorama.position)}this.control.update(),this.activateWidgetItem(t,void 0)},M.Viewer.prototype.disableControl=function(){this.control.enabled=!1},M.Viewer.prototype.toggleNextControl=function(){this.enableControl(this.getNextControlIndex())},M.Viewer.prototype.getScreenVector=function(t){var e=t.clone(),n=this.container.clientWidth/2,i=this.container.clientHeight/2;return e.project(this.camera),e.x=e.x*n+n,e.y=-e.y*i+i,e.z=0,e},M.Viewer.prototype.checkSpriteInViewport=function(t){return this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld),this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.cameraFrustum.setFromMatrix(this.cameraViewProjectionMatrix),t.visible&&this.cameraFrustum.intersectsSprite(t)},M.Viewer.prototype.reverseDraggingDirection=function(){this.OrbitControls.rotateSpeed*=-1,this.OrbitControls.momentumScalingFactor*=-1},M.Viewer.prototype.addReticle=function(){this.reticle=new M.Reticle(16777215,this.options.autoReticleSelect,M.DataImage.ReticleIdle,M.DataImage.ReticleDwell,this.options.dwellTime,45),this.reticle.position.z=-10,this.camera.add(this.reticle),this.scene.add(this.camera)},M.Viewer.prototype.tweenControlCenter=function(t,e,n){if(this.control===this.OrbitControls){t instanceof Array&&(e=t[1],n=t[2],t=t[0]),e=void 0!==e?e:1e3,n=n||L.Easing.Exponential.Out;var i,o,r,a,s,h,c,l,d,u;i=this,a=this.camera.getWorldDirection(),s=a.clone(),l=this.panorama.getWorldPosition().sub(this.camera.getWorldPosition()),h=t.clone(),h.x*=-1,h.add(l).normalize(),c=h.clone(),a.y=0,h.y=0,o=Math.atan2(h.z,h.x)-Math.atan2(a.z,a.x),o=o>Math.PI?o-2*Math.PI:o,o=o<-Math.PI?o+2*Math.PI:o,r=Math.abs(s.angleTo(a)+(s.y*c.y<=0?c.angleTo(h):-c.angleTo(h))),r*=c.y<s.y?1:-1,d={left:0,up:0},u={left:0,up:0},this.tweenLeftAnimation.stop(),this.tweenUpAnimation.stop(),this.tweenLeftAnimation=new L.Tween(d).to({left:o},e).easing(n).onUpdate(function(){i.control.rotateLeft(this.left-u.left),u.left=this.left}).start(),this.tweenUpAnimation=new L.Tween(d).to({up:r},e).easing(n).onUpdate(function(){i.control.rotateUp(this.up-u.up),u.up=this.up}).start()}},M.Viewer.prototype.tweenControlCenterByObject=function(t,e,n){var i=!1;if(t.traverseAncestors(function(t){t.scalePlaceHolder&&(i=!0)}),i){var o=new x.Vector3(-1,1,1);this.tweenControlCenter(t.getWorldPosition().multiply(o),e,n)}else this.tweenControlCenter(t.getWorldPosition(),e,n)},M.Viewer.prototype.onWindowResize=function(t,e){var n,i,o;o=this.container.classList.contains("panolens-container")||this.container.isFullscreen,void 0!==t&&void 0!==e?(n=t,i=e,this.container._width=t,this.container._height=e):(n=o?Math.max(document.documentElement.clientWidth,window.innerWidth||0):this.container.clientWidth,i=o?Math.max(document.documentElement.clientHeight,window.innerHeight||0):this.container.clientHeight,this.container._width=n,this.container._height=i),this.camera.aspect=n/i,this.camera.updateProjectionMatrix(),this.renderer.setSize(n,i),(this.options.enableReticle||this.tempEnableReticle)&&this.updateReticleEvent(),this.dispatchEvent({type:"window-resize",width:n,height:i}),this.scene.traverse(function(t){t.dispatchEvent&&t.dispatchEvent({type:"window-resize",width:n,height:i})})},M.Viewer.prototype.addOutputElement=function(){var t=document.createElement("div");t.style.position="absolute",t.style.right="10px",t.style.top="10px",t.style.color="#fff",this.container.appendChild(t),this.outputDivElement=t},M.Viewer.prototype.outputInfospotPosition=function(){var t,e,n,i;if(t=this.raycaster.intersectObject(this.panorama,!0),t.length>0)switch(e=t[0].point,n=this.panorama.getWorldPosition(),i=new x.Vector3(-(e.x-n.x).toFixed(2),(e.y-n.y).toFixed(2),(e.z-n.z).toFixed(2)),this.options.output){case"console":console.info(i.x+", "+i.y+", "+i.z);break;case"overlay":this.outputDivElement.textContent=i.x+", "+i.y+", "+i.z}},M.Viewer.prototype.onMouseDown=function(t){t.preventDefault(),this.userMouse.x=t.clientX>=0?t.clientX:t.touches[0].clientX,this.userMouse.y=t.clientY>=0?t.clientY:t.touches[0].clientY,this.userMouse.type="mousedown",this.onTap(t)},M.Viewer.prototype.onMouseMove=function(t){t.preventDefault(),this.userMouse.type="mousemove",this.onTap(t)},M.Viewer.prototype.onMouseUp=function(t){var e,n=!1;this.userMouse.type="mouseup",e=this.userMouse.x>=t.clientX-this.options.clickTolerance&&this.userMouse.x<=t.clientX+this.options.clickTolerance&&this.userMouse.y>=t.clientY-this.options.clickTolerance&&this.userMouse.y<=t.clientY+this.options.clickTolerance||t.changedTouches&&this.userMouse.x>=t.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=t.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=t.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=t.changedTouches[0].clientY+this.options.clickTolerance?"click":void 0,t&&t.target&&!t.target.classList.contains("panolens-canvas")||(t.preventDefault(),n=t.changedTouches&&1===t.changedTouches.length?this.onTap({clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY},e):this.onTap(t,e),this.userMouse.type="none",n||"click"===e&&(this.options.autoHideInfospot&&this.panorama&&this.panorama.toggleInfospotVisibility(),this.options.autoHideControlBar&&this.toggleControlBar()))},M.Viewer.prototype.onTap=function(t,e){var n,i,o;if(this.raycasterPoint.x=(t.clientX-this.container.offsetLeft)/this.container.clientWidth*2-1,this.raycasterPoint.y=-(t.clientY-this.container.offsetTop)/this.container.clientHeight*2+1,this.raycaster.setFromCamera(this.raycasterPoint,this.camera),this.panorama)if(("mousedown"!==t.type&&M.Utils.checkTouchSupported()||this.OUTPUT_INFOSPOT)&&this.outputInfospotPosition(),n=this.raycaster.intersectObjects(this.panorama.children,!0),i=this.getConvertedIntersect(n),o=n.length>0?n[0].object:o,"mouseup"===this.userMouse.type&&(i&&this.pressEntityObject===i&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:t}),this.pressEntityObject=void 0),"mouseup"===this.userMouse.type&&(o&&this.pressObject===o&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:t}),this.pressObject=void 0),"click"===e?(this.panorama.dispatchEvent({type:"click",intersects:n,mouseEvent:t}),i&&i.dispatchEvent&&i.dispatchEvent({type:"click-entity",mouseEvent:t}),o&&o.dispatchEvent&&o.dispatchEvent({type:"click",mouseEvent:t})):(this.panorama.dispatchEvent({type:"hover",intersects:n,mouseEvent:t}),(this.hoverObject&&n.length>0&&this.hoverObject!==i||this.hoverObject&&0===n.length)&&(this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverleave",mouseEvent:t}),this.reticle.cancelDwelling()),this.hoverObject=void 0),i&&n.length>0&&(this.hoverObject!==i&&(this.hoverObject=i,this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverenter",mouseEvent:t}),(this.options.autoReticleSelect&&this.options.enableReticle||this.tempEnableReticle)&&this.reticle.startDwelling(this.onTap.bind(this,t,"click")))),"mousedown"===this.userMouse.type&&this.pressEntityObject!=i&&(this.pressEntityObject=i,this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstart-entity",mouseEvent:t})),"mousedown"===this.userMouse.type&&this.pressObject!=o&&(this.pressObject=o,this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstart",mouseEvent:t})),("mousemove"===this.userMouse.type||this.options.enableReticle)&&(o&&o.dispatchEvent&&o.dispatchEvent({type:"hover",mouseEvent:t}),this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressmove-entity",mouseEvent:t}),this.pressObject&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressmove",mouseEvent:t}))),!i&&this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&(this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:t}),this.pressEntityObject=void 0),!o&&this.pressObject&&this.pressObject.dispatchEvent&&(this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:t}),this.pressObject=void 0)),o&&o instanceof M.Infospot){if(this.infospot=o,"click"===e)return!0}else this.infospot&&this.hideInfospot()},M.Viewer.prototype.getConvertedIntersect=function(t){for(var e,n=0;n<t.length;n++)if(t[n].distance>=0&&t[n].object&&!t[n].object.passThrough){if(t[n].object.entity&&t[n].object.entity.passThrough)continue;if(t[n].object.entity&&!t[n].object.entity.passThrough){e=t[n].object.entity;break}e=t[n].object;break}return e},M.Viewer.prototype.hideInfospot=function(t){this.infospot&&(this.infospot.onHoverEnd(),this.infospot=void 0)},M.Viewer.prototype.toggleControlBar=function(){this.widget&&this.widget.dispatchEvent({type:"control-bar-toggle"})},M.Viewer.prototype.onKeyDown=function(t){this.options.output&&"none"!==this.options.output&&"Control"===t.key&&(this.OUTPUT_INFOSPOT=!0)},M.Viewer.prototype.onKeyUp=function(t){this.OUTPUT_INFOSPOT=!1},M.Viewer.prototype.update=function(){L.update(),this.updateCallbacks.forEach(function(t){t()}),this.control.update(),this.scene.traverse(function(t){if(t instanceof M.Infospot&&t.element&&(this.hoverObject===t||"none"!==t.element.style.display||t.element.left&&"none"!==t.element.left.style.display||t.element.right&&"none"!==t.element.right.style.display))if(this.checkSpriteInViewport(t)){var e=this.getScreenVector(t.getWorldPosition());t.translateElement(e.x,e.y)}else t.onDismiss()}.bind(this))},M.Viewer.prototype.render=function(){this.mode===M.Modes.CARDBOARD||this.mode===M.Modes.STEREO?this.effect.render(this.scene,this.camera):this.renderer.render(this.scene,this.camera)},M.Viewer.prototype.animate=function(){this.requestAnimationId=window.requestAnimationFrame(this.animate.bind(this)),this.onChange()},M.Viewer.prototype.onChange=function(){this.update(),this.render()},M.Viewer.prototype.registerMouseAndTouchEvents=function(){this.container.addEventListener("mousedown",this.HANDLER_MOUSE_DOWN,!1),this.container.addEventListener("mousemove",this.HANDLER_MOUSE_MOVE,!1),this.container.addEventListener("mouseup",this.HANDLER_MOUSE_UP,!1),this.container.addEventListener("touchstart",this.HANDLER_MOUSE_DOWN,!1),this.container.addEventListener("touchend",this.HANDLER_MOUSE_UP,!1)},M.Viewer.prototype.unregisterMouseAndTouchEvents=function(){this.container.removeEventListener("mousedown",this.HANDLER_MOUSE_DOWN,!1),this.container.removeEventListener("mousemove",this.HANDLER_MOUSE_MOVE,!1),this.container.removeEventListener("mouseup",this.HANDLER_MOUSE_UP,!1),this.container.removeEventListener("touchstart",this.HANDLER_MOUSE_DOWN,!1),this.container.removeEventListener("touchend",this.HANDLER_MOUSE_UP,!1)},M.Viewer.prototype.registerReticleEvent=function(){this.addUpdateCallback(this.HANDLER_TAP)},M.Viewer.prototype.unregisterReticleEvent=function(){this.removeUpdateCallback(this.HANDLER_TAP)},M.Viewer.prototype.updateReticleEvent=function(){var t,e;t=this.container.clientWidth/2+this.container.offsetLeft,e=this.container.clientHeight/2,this.removeUpdateCallback(this.HANDLER_TAP),this.HANDLER_TAP=this.onTap.bind(this,{clientX:t,clientY:e}),this.addUpdateCallback(this.HANDLER_TAP)},M.Viewer.prototype.registerEventListeners=function(){window.addEventListener("resize",this.HANDLER_WINDOW_RESIZE,!0),window.addEventListener("keydown",this.HANDLER_KEY_DOWN,!0),window.addEventListener("keyup",this.HANDLER_KEY_UP,!0)},M.Viewer.prototype.unregisterEventListeners=function(){window.removeEventListener("resize",this.HANDLER_WINDOW_RESIZE,!0),window.removeEventListener("keydown",this.HANDLER_KEY_DOWN,!0),window.removeEventListener("keyup",this.HANDLER_KEY_UP,!0)},M.Viewer.prototype.dispose=function(){function t(e){for(var n=e.children.length-1;n>=0;n--)t(e.children[n]),e.remove(e.children[n]);e instanceof M.Infospot&&e.dispose(),e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}this.unregisterEventListeners(),t(this.scene),this.widget&&(this.widget.dispose(),this.widget=null),x.Cache&&x.Cache.enabled&&x.Cache.clear()},M.Viewer.prototype.destory=function(){this.dispose(),this.render(),window.cancelAnimationFrame(this.requestAnimationId)},M.Viewer.prototype.onPanoramaDispose=function(t){t instanceof M.VideoPanorama&&this.hideVideoWidget(),t===this.panorama&&(this.panorama=null)},M.Viewer.prototype.loadAsyncRequest=function(t,e){var n=new XMLHttpRequest;n.onloadend=function(t){e&&e(t)},n.open("GET",t,!0),n.send(null)},M.Viewer.prototype.addViewIndicator=function(){function t(t){if(0!==t.loaded){var n=t.target.responseXML.documentElement;n.style.width=e.viewIndicatorSize+"px",n.style.height=e.viewIndicatorSize+"px",n.style.position="absolute",n.style.top="10px",n.style.left="10px",n.style.opacity="0.5",n.style.cursor="pointer",n.id="panolens-view-indicator-container",e.container.appendChild(n);var i=n.querySelector("#indicator"),o=function(){e.radius=.225*e.viewIndicatorSize,e.currentPanoAngle=e.camera.rotation.y-x.Math.degToRad(90),e.fovAngle=x.Math.degToRad(e.camera.fov),e.leftAngle=-e.currentPanoAngle-e.fovAngle/2,e.rightAngle=-e.currentPanoAngle+e.fovAngle/2,e.leftX=e.radius*Math.cos(e.leftAngle),e.leftY=e.radius*Math.sin(e.leftAngle),e.rightX=e.radius*Math.cos(e.rightAngle),e.rightY=e.radius*Math.sin(e.rightAngle),e.indicatorD="M "+e.leftX+" "+e.leftY+" A "+e.radius+" "+e.radius+" 0 0 1 "+e.rightX+" "+e.rightY,e.leftX&&e.leftY&&e.rightX&&e.rightY&&e.radius&&i.setAttribute("d",e.indicatorD)};e.addUpdateCallback(o);var r=function(){this.style.opacity="1"},a=function(){this.style.opacity="0.5"};n.addEventListener("mouseenter",r),n.addEventListener("mouseleave",a)}}var e=this;this.loadAsyncRequest(M.DataImage.ViewIndicator,t)},M.Viewer.prototype.appendControlItem=function(t){var e=this.widget.createCustomItem(t);return"video"===t.group?this.widget.videoElement.appendChild(e):this.widget.barElement.appendChild(e),e}}(),function t(e,n,i){function o(s,h){if(!n[s]){if(!e[s]){var c="function"==typeof r&&r;if(!h&&c)return r(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[s]={exports:{}};e[s][0].call(d.exports,function(t){return o(e[s][1][t]||t)},d,d.exports,t,e,n,i)}return n[s].exports}for(var a="function"==typeof r&&r,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){function i(t){d.call(this),"string"==typeof t&&(t={text:t}),this._opt=h({},t),t&&this.update(t)}var o=t("layout-bmfont-text"),r=t("inherits"),a=t("quad-indices"),s=t("three-buffer-vertex-data"),h=t("object-assign"),c=t("./lib/vertices"),l=t("./lib/utils"),d=x.BufferGeometry;e.exports=function(t){return new i(t)},r(i,d),i.prototype.update=function(t){if("string"==typeof t&&(t={text:t}),t=h({},this._opt,t),!t.font)throw new TypeError("must specify a { font } in options");this.layout=o(t);var e=!1!==t.flipY,n=t.font,i=n.common.scaleW,r=n.common.scaleH,l=this.layout.glyphs.filter(function(t){var e=t.data;return e.width*e.height>0});this.visibleGlyphs=l;var d=c.positions(l),u=c.uvs(l,i,r,e),p=a({clockwise:!0,type:"uint16",count:l.length});if(s.index(this,p,1,"uint16"),s.attr(this,"position",d,2),s.attr(this,"uv",u,2),!t.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(t.multipage){var f=c.pages(l);s.attr(this,"page",f,1)}},i.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new x.Sphere);var t=this.attributes.position.array,e=this.attributes.position.itemSize;if(!t||!e||t.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);l.computeSphere(t,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},i.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new x.Box3);var t=this.boundingBox,e=this.attributes.position.array,n=this.attributes.position.itemSize;if(!e||!n||e.length<2)return void t.makeEmpty();l.computeBox(e,t)}},{"./lib/utils":2,"./lib/vertices":3,inherits:4,"layout-bmfont-text":5,"object-assign":26,"quad-indices":27,"three-buffer-vertex-data":31}],2:[function(t,e,n){function i(t){var e=t.length/o;r.min[0]=t[0],r.min[1]=t[1],r.max[0]=t[0],r.max[1]=t[1];for(var n=0;n<e;n++){var i=t[n*o+0],a=t[n*o+1];r.min[0]=Math.min(i,r.min[0]),r.min[1]=Math.min(a,r.min[1]),r.max[0]=Math.max(i,r.max[0]),r.max[1]=Math.max(a,r.max[1])}}var o=2,r={min:[0,0],max:[0,0]};e.exports.computeBox=function(t,e){i(t),e.min.set(r.min[0],r.min[1],0),e.max.set(r.max[0],r.max[1],0)},e.exports.computeSphere=function(t,e){i(t);var n=r.min[0],o=r.min[1],a=r.max[0],s=r.max[1],h=a-n,c=s-o,l=Math.sqrt(h*h+c*c);e.center.set(n+h/2,o+c/2,0),e.radius=l/2}},{}],3:[function(t,e,n){e.exports.pages=function(t){var e=new Float32Array(4*t.length*1),n=0;return t.forEach(function(t){var i=t.data.page||0;e[n++]=i,e[n++]=i,e[n++]=i,e[n++]=i}),e},e.exports.uvs=function(t,e,n,i){var o=new Float32Array(4*t.length*2),r=0;return t.forEach(function(t){var a=t.data,s=a.x+a.width,h=a.y+a.height,c=a.x/e,l=a.y/n,d=s/e,u=h/n;i&&(l=(n-a.y)/n,u=(n-h)/n),o[r++]=c,o[r++]=l,o[r++]=c,o[r++]=u,o[r++]=d,o[r++]=u,o[r++]=d,o[r++]=l}),o},e.exports.positions=function(t){var e=new Float32Array(4*t.length*2),n=0;return t.forEach(function(t){var i=t.data,o=t.position[0]+i.xoffset,r=t.position[1]+i.yoffset,a=i.width,s=i.height;e[n++]=o,e[n++]=r,e[n++]=o,e[n++]=r+s,e[n++]=o+a,e[n++]=r+s,e[n++]=o+a,e[n++]=r}),e}},{}],4:[function(t,e,n){"function"==typeof m.a?e.exports=function(t,e){t.super_=e,t.prototype=m()(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],5:[function(t,e,n){function i(t){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(t)}function o(t){E()(i.prototype,t,{get:r(t),configurable:!0})}function r(t){return new Function(["return function "+t+"() {","  return this._"+t,"}"].join("\n"))()}function a(t,e){if(!t.chars||0===t.chars.length)return null;var n=f(t.chars,e);return n>=0?t.chars[n]:null}function s(t){for(var e=0;e<v.length;e++){var n=v[e].charCodeAt(0),i=f(t.chars,n);if(i>=0)return t.chars[i].height}return 0}function h(t){for(var e=0;e<g.length;e++){var n=g[e].charCodeAt(0),i=f(t.chars,n);if(i>=0)return t.chars[i]}return 0}function c(t){for(var e=0;e<y.length;e++){var n=y[e].charCodeAt(0),i=f(t.chars,n);if(i>=0)return t.chars[i].height}return 0}function l(t,e,n){if(!t.kernings||0===t.kernings.length)return 0;for(var i=t.kernings,o=0;o<i.length;o++){var r=i[o];if(r.first===e&&r.second===n)return r.amount}return 0}function d(t){return"center"===t?M:"right"===t?T:x}var u=t("word-wrapper"),p=t("xtend"),f=t("indexof-property")("id"),m=t("as-number"),v=["x","e","a","o","n","s","r","c","u","m","v","w","z"],g=["m","w"],y=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],w="\t".charCodeAt(0),b=" ".charCodeAt(0),x=0,M=1,T=2;e.exports=function(t){return new i(t)},i.prototype.update=function(t){if(t=p({measure:this._measure},t),this._opt=t,this._opt.tabSize=m(this._opt.tabSize,4),!t.font)throw new Error("must provide a valid bitmap font");var e=this.glyphs,n=t.text||"",i=t.font;this._setupSpaceGlyphs(i);var o=u.lines(n,t),r=t.width||0;e.length=0;var a=o.reduce(function(t,e){return Math.max(t,e.width,r)},0),h=0,f=0,v=m(t.lineHeight,i.common.lineHeight),g=i.common.base,y=v-g,w=t.letterSpacing||0,b=v*o.length-y,E=d(this._opt.align);f-=b,this._width=a,this._height=b,this._descender=v-g,this._baseline=g,this._xHeight=s(i),this._capHeight=c(i),this._lineHeight=v,this._ascender=v-y-this._xHeight;var x=this;o.forEach(function(t,o){for(var r,s=t.start,c=t.end,d=t.width,u=s;u<c;u++){var p=n.charCodeAt(u),m=x.getGlyph(i,p);if(m){r&&(h+=l(i,r.id,m.id));var g=h;E===M?g+=(a-d)/2:E===T&&(g+=a-d),e.push({position:[g,f],data:m,index:u,line:o}),h+=m.xadvance+w,r=m}}f+=v,h=0}),this._linesTotal=o.length},i.prototype._setupSpaceGlyphs=function(t){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,t.chars&&0!==t.chars.length){var e=a(t,b)||h(t)||t.chars[0],n=this._opt.tabSize*e.xadvance;this._fallbackSpaceGlyph=e,this._fallbackTabGlyph=p(e,{x:0,y:0,xadvance:n,id:w,xoffset:0,yoffset:0,width:0,height:0})}},i.prototype.getGlyph=function(t,e){var n=a(t,e);return n||(e===w?this._fallbackTabGlyph:e===b?this._fallbackSpaceGlyph:null)},i.prototype.computeMetrics=function(t,e,n,i){var o,r,a=this._opt.letterSpacing||0,s=this._opt.font,h=0,c=0,d=0;if(!s.chars||0===s.chars.length)return{start:e,end:e,width:0};n=Math.min(t.length,n);for(var u=e;u<n;u++){var p=t.charCodeAt(u),o=this.getGlyph(s,p);if(o){o.xoffset;h+=r?l(s,r.id,o.id):0;var f=h+o.xadvance+a,m=h+o.width;if(m>=i||f>=i)break;h=f,c=m,r=o}d++}return r&&(c+=r.xoffset),{start:e,end:e+d,width:c}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(o)},{"as-number":6,"indexof-property":7,"word-wrapper":8,xtend:9}],6:[function(t,e,n){e.exports=function(t,e){return"number"==typeof t?t:"number"==typeof e?e:0}},{}],7:[function(t,e,n){e.exports=function(t){if(!t||"string"!=typeof t)throw new Error("must specify property for indexof search");return new Function("array","value","start",["start = start || 0","for (var i=start; i<array.length; i++)",'  if (array[i]["'+t+'"] === value)',"      return i","return -1"].join("\n"))}},{}],8:[function(t,e,n){function i(t,e,n,i){var o=t.indexOf(e,n);return-1===o||o>i?i:o}function o(t){return l.test(t)}function r(t,e,n,i,o){for(var r=[],a=n,s=n;s<i&&s<e.length;s++){var c=e.charAt(s),l=h.test(c);if(l||s===i-1){var d=l?s:s+1,u=t(e,a,d,o);r.push(u),a=s+1}}return r}function a(t,e,n,r,a,s){var h=[],l=a;for("nowrap"===s&&(l=Number.MAX_VALUE);n<r&&n<e.length;){for(var d=i(e,c,n,r);n<d&&o(e.charAt(n));)n++;var u=t(e,n,d,l),p=n+(u.end-u.start),f=p+c.length;if(p<d){for(;p>n&&!o(e.charAt(p));)p--;if(p===n)f>n+c.length&&f--,p=f;else for(f=p;p>n&&o(e.charAt(p-c.length));)p--}if(p>=n){var m=t(e,n,p,l);h.push(m)}n=f}return h}function s(t,e,n,i){return{start:e,end:e+Math.min(i,n-e)}}var h=/\n/,c="\n",l=/\s/;e.exports=function(t,n){return e.exports.lines(t,n).map(function(e){return t.substring(e.start,e.end)}).join("\n")},e.exports.lines=function(t,e){if(e=e||{},0===e.width&&"nowrap"!==e.mode)return[];t=t||"";var n="number"==typeof e.width?e.width:Number.MAX_VALUE,i=Math.max(0,e.start||0),o="number"==typeof e.end?e.end:t.length,h=e.mode,c=e.measure||s;return"pre"===h?r(c,t,i,o,n):a(c,t,i,o,n,h)}},{}],9:[function(t,e,n){function i(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)o.call(n,i)&&(t[i]=n[i])}return t}e.exports=i;var o=Object.prototype.hasOwnProperty},{}],10:[function(t,e,n){(function(n){function i(t){return"[object ArrayBuffer]"===Object.prototype.toString.call(t)}function o(t){if(u)return d(t,{responseType:"arraybuffer"});if(void 0===window.XMLHttpRequest)throw new Error("your browser does not support XHR loading");var e=new window.XMLHttpRequest;return e.overrideMimeType("text/plain; charset=x-user-defined"),d({xhr:e},t)}var r=t("xhr"),a=function(){},s=t("parse-bmfont-ascii"),h=t("parse-bmfont-xml"),c=t("parse-bmfont-binary"),l=t("./lib/is-binary"),d=t("xtend"),u=function(){return window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();e.exports=function(t,e){e="function"==typeof e?e:a,"string"==typeof t?t={uri:t}:t||(t={}),t.binary&&(t=o(t)),r(t,function(o,r,d){if(o)return e(o);if(!/^2/.test(r.statusCode))return e(new Error("http status code: "+r.statusCode));if(!d)return e(new Error("no body result"));var u=!1;if(i(d)){var p=new Uint8Array(d);d=new n(p,"binary")}l(d)&&(u=!0,"string"==typeof d&&(d=new n(d,"binary"))),u||(n.isBuffer(d)&&(d=d.toString(t.encoding)),d=d.trim());var f;try{var m=r.headers["content-type"];f=u?c(d):/json/.test(m)||"{"===d.charAt(0)?JSON.parse(d):/xml/.test(m)||"<"===d.charAt(0)?h(d):s(d)}catch(t){e(new Error("error parsing font "+t.message)),e=a}e(null,f)})}}).call(this,t("buffer").Buffer)},{"./lib/is-binary":11,buffer:37,"parse-bmfont-ascii":13,"parse-bmfont-binary":14,"parse-bmfont-xml":15,xhr:18,xtend:25}],11:[function(t,e,n){(function(n){var i=t("buffer-equal"),o=new n([66,77,70,3]);e.exports=function(t){return"string"==typeof t?"BMF"===t.substring(0,3):t.length>4&&i(t.slice(0,4),o)}}).call(this,t("buffer").Buffer)},{buffer:37,"buffer-equal":12}],12:[function(t,e,n){var i=t("buffer").Buffer;e.exports=function(t,e){if(i.isBuffer(t)&&i.isBuffer(e)){if("function"==typeof t.equals)return t.equals(e);if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}}},{buffer:37}],13:[function(t,e,n){function i(t,e){if(!(t=t.replace(/\t+/g," ").trim()))return null;var n=t.indexOf(" ");if(-1===n)throw new Error("no named row at line "+e);var i=t.substring(0,n);t=t.substring(n+1),t=t.replace(/letter=[\'\"]\S+[\'\"]/gi,""),t=t.split("="),t=t.map(function(t){return t.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var r=[],a=0;a<t.length;a++){var s=t[a];0===a?r.push({key:s[0],data:""}):a===t.length-1?r[r.length-1].data=o(s[0]):(r[r.length-1].data=o(s[0]),r.push({key:s[1],data:""}))}var h={key:i,data:{}};return r.forEach(function(t){h.data[t.key]=t.data}),h}function o(t){return t&&0!==t.length?0===t.indexOf('"')||0===t.indexOf("'")?t.substring(1,t.length-1):-1!==t.indexOf(",")?r(t):parseInt(t,10):""}function r(t){return t.split(",").map(function(t){return parseInt(t,10)})}e.exports=function(t){if(!t)throw new Error("no data provided");t=t.toString().trim();var e={pages:[],chars:[],kernings:[]},n=t.split(/\r\n?|\n/g);if(0===n.length)throw new Error("no data in BMFont file");for(var o=0;o<n.length;o++){var r=i(n[o],o);if(r)if("page"===r.key){if("number"!=typeof r.data.id)throw new Error("malformed file at line "+o+" -- needs page id=N");if("string"!=typeof r.data.file)throw new Error("malformed file at line "+o+' -- needs page file="path"');e.pages[r.data.id]=r.data.file}else"chars"===r.key||"kernings"===r.key||("char"===r.key?e.chars.push(r.data):"kerning"===r.key?e.kernings.push(r.data):e[r.key]=r.data)}return e}},{}],14:[function(t,e,n){function i(t,e,n){if(n>e.length-1)return 0;var i=e.readUInt8(n++),c=e.readInt32LE(n);switch(n+=4,i){case 1:t.info=o(e,n);break;case 2:t.common=r(e,n);break;case 3:t.pages=a(e,n,c);break;case 4:t.chars=s(e,n,c);break;case 5:t.kernings=h(e,n,c)}return 5+c}function o(t,e){var n={};n.size=t.readInt16LE(e);var i=t.readUInt8(e+2);return n.smooth=i>>7&1,n.unicode=i>>6&1,n.italic=i>>5&1,n.bold=i>>4&1,i>>3&1&&(n.fixedHeight=1),n.charset=t.readUInt8(e+3)||"",n.stretchH=t.readUInt16LE(e+4),n.aa=t.readUInt8(e+6),n.padding=[t.readInt8(e+7),t.readInt8(e+8),t.readInt8(e+9),t.readInt8(e+10)],n.spacing=[t.readInt8(e+11),t.readInt8(e+12)],n.outline=t.readUInt8(e+13),n.face=l(t,e+14),n}function r(t,e){var n={};n.lineHeight=t.readUInt16LE(e),n.base=t.readUInt16LE(e+2),n.scaleW=t.readUInt16LE(e+4),n.scaleH=t.readUInt16LE(e+6),n.pages=t.readUInt16LE(e+8);t.readUInt8(e+10);return n.packed=0,n.alphaChnl=t.readUInt8(e+11),n.redChnl=t.readUInt8(e+12),n.greenChnl=t.readUInt8(e+13),n.blueChnl=t.readUInt8(e+14),n}function a(t,e,n){for(var i=[],o=c(t,e),r=o.length+1,a=n/r,s=0;s<a;s++)i[s]=t.slice(e,e+o.length).toString("utf8"),e+=r;return i}function s(t,e,n){for(var i=[],o=n/20,r=0;r<o;r++){var a={},s=20*r;a.id=t.readUInt32LE(e+0+s),a.x=t.readUInt16LE(e+4+s),a.y=t.readUInt16LE(e+6+s),a.width=t.readUInt16LE(e+8+s),a.height=t.readUInt16LE(e+10+s),a.xoffset=t.readInt16LE(e+12+s),a.yoffset=t.readInt16LE(e+14+s),a.xadvance=t.readInt16LE(e+16+s),a.page=t.readUInt8(e+18+s),a.chnl=t.readUInt8(e+19+s),i[r]=a}return i}function h(t,e,n){for(var i=[],o=n/10,r=0;r<o;r++){var a={},s=10*r;a.first=t.readUInt32LE(e+0+s),a.second=t.readUInt32LE(e+4+s),a.amount=t.readInt16LE(e+8+s),i[r]=a}return i}function c(t,e){for(var n=e;n<t.length&&0!==t[n];n++);return t.slice(e,n)}function l(t,e){return c(t,e).toString("utf8")}var d=[66,77,70];e.exports=function(t){if(t.length<6)throw new Error("invalid buffer length for BMFont");if(!d.every(function(e,n){return t.readUInt8(n)===e}))throw new Error("BMFont missing BMF byte header");var e=3;if(t.readUInt8(e++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var n={kernings:[],chars:[]},o=0;o<5;o++)e+=i(n,t,e);return n}},{}],15:[function(t,e,n){function i(t){return o(t).reduce(function(t,e){return t[r(e.nodeName)]=e.nodeValue,t},{})}function o(t){for(var e=[],n=0;n<t.attributes.length;n++)e.push(t.attributes[n]);return e}function r(t){return h[t.toLowerCase()]||t}var a=t("./parse-attribs"),s=t("xml-parse-from-string"),h={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};e.exports=function(t){t=t.toString();var e=s(t),n={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(t){var o=e.getElementsByTagName(t)[0];o&&(n[t]=a(i(o)))});var o=e.getElementsByTagName("pages")[0];if(!o)throw new Error("malformed file -- no <pages> element");for(var r=o.getElementsByTagName("page"),h=0;h<r.length;h++){var c=r[h],l=parseInt(c.getAttribute("id"),10),d=c.getAttribute("file");if(isNaN(l))throw new Error('malformed file -- page "id" attribute is NaN');if(!d)throw new Error('malformed file -- needs page "file" attribute');n.pages[parseInt(l,10)]=d}return["chars","kernings"].forEach(function(t){var o=e.getElementsByTagName(t)[0];if(o)for(var r=t.substring(0,t.length-1),s=o.getElementsByTagName(r),h=0;h<s.length;h++){var c=s[h];n[t].push(a(i(c)))}}),n}},{"./parse-attribs":16,"xml-parse-from-string":17}],16:[function(t,e,n){function i(t){return t.split(",").map(function(t){return parseInt(t,10)})}e.exports=function(t){"chasrset"in t&&(t.charset=t.chasrset,delete t.chasrset);for(var e in t)"face"!==e&&"charset"!==e&&(t[e]="padding"===e||"spacing"===e?i(t[e]):parseInt(t[e],10));return t}},{}],17:[function(t,e,n){e.exports=function(){return void 0!==window.DOMParser?function(t){return(new window.DOMParser).parseFromString(t,"application/xml")}:void 0!==window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")?function(t){var e=new window.ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}:function(t){var e=document.createElement("div");return e.innerHTML=t,e}}()},{}],18:[function(t,e,n){function i(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}function o(t,e,n){var i=t;return l(e)?(n=e,"string"==typeof t&&(i={uri:t})):i=u(e,{uri:t}),i.callback=n,i}function r(t,e,n){return e=o(t,e,n),a(e)}function a(t){function e(){4===l.readyState&&a()}function n(){var t=void 0;if(l.response?t=l.response:"text"!==l.responseType&&l.responseType||(t=l.responseText||l.responseXML),E)try{t=JSON.parse(t)}catch(t){}return t}function o(t){clearTimeout(m),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,s(t,h)}function a(){if(!f){var e;clearTimeout(m),e=t.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var i=h,o=null;0!==e?(i={body:n(),statusCode:e,method:g,headers:{},url:v,rawRequest:l},l.getAllResponseHeaders&&(i.headers=d(l.getAllResponseHeaders()))):o=new Error("Internal XMLHttpRequest Error"),s(o,i,i.body)}}var s=t.callback;if(void 0===s)throw new Error("callback argument missing");s=c(s);var h={body:void 0,headers:{},statusCode:0,method:g,url:v,rawRequest:l},l=t.xhr||null;l||(l=t.cors||t.useXDR?new r.XDomainRequest:new r.XMLHttpRequest);var u,f,m,v=l.url=t.uri||t.url,g=l.method=t.method||"GET",y=t.body||t.data||null,w=l.headers=t.headers||{},b=!!t.sync,E=!1;if("json"in t&&(E=!0,w.accept||w.Accept||(w.Accept="application/json"),"GET"!==g&&"HEAD"!==g&&(w["content-type"]||w["Content-Type"]||(w["Content-Type"]="application/json"),y=p()(t.json))),l.onreadystatechange=e,l.onload=a,l.onerror=o,l.onprogress=function(){},l.ontimeout=o,l.open(g,v,!b,t.username,t.password),b||(l.withCredentials=!!t.withCredentials),!b&&t.timeout>0&&(m=setTimeout(function(){f=!0,l.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",o(t)},t.timeout)),l.setRequestHeader)for(u in w)w.hasOwnProperty(u)&&l.setRequestHeader(u,w[u]);else if(t.headers&&!i(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(l.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(l),l.send(y),l}function s(){}var h=t("global/window"),c=t("once"),l=t("is-function"),d=t("parse-headers"),u=t("xtend");e.exports=r,r.XMLHttpRequest=h.XMLHttpRequest||s,r.XDomainRequest="withCredentials"in new r.XMLHttpRequest?r.XMLHttpRequest:h.XDomainRequest,function(t,e){for(var n=0;n<t.length;n++)e(t[n])}(["get","put","post","patch","head","delete"],function(t){r["delete"===t?"del":t]=function(e,n,i){return n=o(e,n,i),n.method=t.toUpperCase(),a(n)}})},{"global/window":19,"is-function":20,once:21,"parse-headers":24,xtend:25}],19:[function(t,e,n){(function(t){"undefined"!=typeof window?e.exports=window:void 0!==t?e.exports=t:"undefined"!=typeof self?e.exports=self:e.exports={}}).call(this,void 0!==o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(t,e,n){function i(t){var e=o.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)}e.exports=i;var o=Object.prototype.toString},{}],21:[function(t,e,n){function i(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}e.exports=i,i.proto=i(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return i(this)},configurable:!0})})},{}],22:[function(t,e,n){function i(t,e,n){if(!s(e))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===h.call(t)?o(t,e,n):"string"==typeof t?r(t,e,n):a(t,e,n)}function o(t,e,n){for(var i=0,o=t.length;i<o;i++)c.call(t,i)&&e.call(n,t[i],i,t)}function r(t,e,n){for(var i=0,o=t.length;i<o;i++)e.call(n,t.charAt(i),i,t)}function a(t,e,n){for(var i in t)c.call(t,i)&&e.call(n,t[i],i,t)}var s=t("is-function");e.exports=i;var h=Object.prototype.toString,c=Object.prototype.hasOwnProperty},{"is-function":20}],23:[function(t,e,n){function i(t){return t.replace(/^\s*|\s*$/g,"")}n=e.exports=i,n.left=function(t){return t.replace(/^\s*/,"")},n.right=function(t){return t.replace(/\s*$/,"")}},{}],24:[function(t,e,n){var i=t("trim"),o=t("for-each"),r=function(t){return"[object Array]"===Object.prototype.toString.call(t)};e.exports=function(t){if(!t)return{};var e={};return o(i(t).split("\n"),function(t){var n=t.indexOf(":"),o=i(t.slice(0,n)).toLowerCase(),a=i(t.slice(n+1));void 0===e[o]?e[o]=a:r(e[o])?e[o].push(a):e[o]=[e[o],a]}),e}},{"for-each":22,trim:23}],25:[function(t,e,n){arguments[4][9][0].apply(n,arguments)},{dup:9}],26:[function(t,e,n){function i(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=c.a||function(t,e){for(var n,a,h=i(t),c=1;c<arguments.length;c++){n=Object(arguments[c]);for(var l in n)o.call(n,l)&&(h[l]=n[l]);if(s.a){a=s()(n);for(var d=0;d<a.length;d++)r.call(n,a[d])&&(h[a[d]]=n[a[d]])}}return h}},{}],27:[function(t,e,n){var i=t("dtype"),o=t("an-array"),r=t("is-buffer"),a=[0,2,3],s=[2,1,3];e.exports=function(t,e){t&&(o(t)||r(t))||(e=t||{},t=null),e="number"==typeof e?{count:e}:e||{};for(var n="string"==typeof e.type?e.type:"uint16",h="number"==typeof e.count?e.count:1,c=e.start||0,l=!1!==e.clockwise?a:s,d=l[0],u=l[1],p=l[2],f=6*h,m=t||new(i(n))(f),v=0,g=0;v<f;v+=6,g+=4){var y=v+c;m[y+0]=g+0,m[y+1]=g+1,m[y+2]=g+2,m[y+3]=g+d,m[y+4]=g+u,m[y+5]=g+p}return m}},{"an-array":28,dtype:29,"is-buffer":30}],28:[function(t,e,n){function i(t){return t.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===o.call(t.buffer)||Array.isArray(t)}var o=Object.prototype.toString;e.exports=i},{}],29:[function(t,e,n){e.exports=function(t){switch(t){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],30:[function(t,e,n){e.exports=function(t){return!(null==t||!(t._isBuffer||t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)))}},{}],31:[function(t,e,n){function i(t,e,n,i){"number"!=typeof n&&(n=1),"number"!=typeof i&&(i="uint16");var o=!t.index&&"function"!=typeof t.setIndex,a=o?t.getAttribute("index"):t.index,s=r(a,e,n,i);s&&(o?t.addAttribute("index",s):t.index=s)}function o(t,e,n,i,o){if("number"!=typeof i&&(i=3),"number"!=typeof o&&(o="float32"),Array.isArray(n)&&Array.isArray(n[0])&&n[0].length!==i)throw new Error("Nested vertex array has unexpected size; expected "+i+" but found "+n[0].length);var a=t.getAttribute(e),s=r(a,n,i,o);s&&t.addAttribute(e,s)}function r(t,e,n,i){return e=e||[],!t||a(t,e,n)?(e=s(e,i),t=new x.BufferAttribute(e,n),t.needsUpdate=!0,t):(s(e,t.array),t.needsUpdate=!0,null)}function a(t,e,n){if(t.itemSize!==n)return!0;if(!t.array)return!0;var i=t.array.length;return Array.isArray(e)&&Array.isArray(e[0])?i!==e.length*n:i!==e.length}var s=t("flatten-vertex-data");e.exports.attr=o,e.exports.index=i},{"flatten-vertex-data":32}],32:[function(t,e,n){function i(t,e,n){if(!t)throw new TypeError("must specify data as first parameter");if(n=0|+(n||0),Array.isArray(t)&&Array.isArray(t[0])){var i=t[0].length,r=t.length*i;e&&"string"!=typeof e||(e=new(o(e||"float32"))(r+n));var a=e.length-n;if(r!==a)throw new Error("source length "+r+" ("+i+"x"+t.length+") does not match destination length "+a);for(var s=0,h=n;s<t.length;s++)for(var c=0;c<i;c++)e[h++]=t[s][c]}else if(e&&"string"!=typeof e)e.set(t,n);else{var l=o(e||"float32");0===n?e=new l(t):(e=new l(t.length+n),e.set(t,n))}return e}var o=t("dtype");e.exports=i},{dtype:33}],33:[function(t,e,n){arguments[4][29][0].apply(n,arguments)},{dup:29}],34:[function(t,e,n){var i=t("object-assign");e.exports=function(t){t=t||{};var e="number"==typeof t.opacity?t.opacity:1,n="number"==typeof t.alphaTest?t.alphaTest:1e-4,o=t.precision||"highp",r=t.color,a=t.map;return delete t.map,delete t.color,delete t.precision,delete t.opacity,i({uniforms:{opacity:{type:"f",value:e},map:{type:"t",value:a||new x.Texture},color:{type:"c",value:new x.Color(r)}},vertexShader:["attribute vec2 uv;","attribute vec4 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * position;","}"].join("\n"),fragmentShader:["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives : enable","#endif","precision "+o+" float;","uniform float opacity;","uniform vec3 color;","uniform sampler2D map;","varying vec2 vUv;","float aastep(float value) {","  #ifdef GL_OES_standard_derivatives","    float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;","  #else","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","  #endif","  return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","}","void main() {","  vec4 texColor = texture2D(map, vUv);","  float alpha = aastep(texColor.a);","  gl_FragColor = vec4(color, opacity * alpha);",0===n?"":"  if (gl_FragColor.a < "+n+") discard;","}"].join("\n")},t)}},{"object-assign":26}],35:[function(t,e,n){var i=t("load-bmfont");e.exports=function(t,e){i(t.font,function(n,i){if(n)throw n;M.Utils.TextureLoader.load(t.image,function(t){e(i,t)})})}},{"load-bmfont":10}],36:[function(t,e,n){var i=t("../"),o=t("../shaders/sdf");M&&M.Utils&&M.SpriteText&&(M.Utils.loadBMFont=function(e,n){t("./load")(e,M.SpriteText.prototype.setBMFont.bind(M.SpriteText.prototype,n))},M.SpriteText.prototype.generateTextGeometry=i,M.SpriteText.prototype.generateSDFShader=o)},{"../":1,"../shaders/sdf":34,"./load":35}],37:[function(t,e,n){(function(e){function i(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t){return this instanceof o?(o.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof t?r(this,t):"string"==typeof t?a(this,t,arguments.length>1?arguments[1]:"utf8"):s(this,t)):arguments.length>1?new o(t,arguments[1]):new o(t)}function r(t,e){if(t=f(t,e<0?0:0|m(e)),!o.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;n++)t[n]=0;return t}function a(t,e,n){return"string"==typeof n&&""!==n||(n="utf8"),t=f(t,0|g(e,n)),t.write(e,n),t}function s(t,e){if(o.isBuffer(e))return h(t,e);if($(e))return c(t,e);if(null==e)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(e.buffer instanceof ArrayBuffer)return l(t,e);if(e instanceof ArrayBuffer)return d(t,e)}return e.length?u(t,e):p(t,e)}function h(t,e){var n=0|m(e.length);return t=f(t,n),e.copy(t,0,0,n),t}function c(t,e){var n=0|m(e.length);t=f(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function l(t,e){var n=0|m(e.length);t=f(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function d(t,e){return o.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=o.prototype):t=l(t,new Uint8Array(e)),t}function u(t,e){var n=0|m(e.length);t=f(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function p(t,e){var n,i=0;"Buffer"===e.type&&$(e.data)&&(n=e.data,i=0|m(n.length)),t=f(t,i);for(var o=0;o<i;o+=1)t[o]=255&n[o];return t}function f(t,e){return o.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=o.prototype):t.length=e,0!==e&&e<=o.poolSize>>>1&&(t.parent=Z),t}function m(t){if(t>=i())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i().toString(16)+" bytes");return 0|t}function v(t,e){if(!(this instanceof v))return new v(t,e);var n=new o(t,e);return delete n.parent,n}function g(t,e){"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"binary":case"raw":case"raws":return n;case"utf8":case"utf-8":return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(t).length;default:if(i)return H(t).length;e=(""+e).toLowerCase(),i=!0}}function y(t,e,n){var i=!1;if(e|=0,n=void 0===n||n===1/0?this.length:0|n,t||(t="utf8"),e<0&&(e=0),n>this.length&&(n=this.length),n<=e)return"";for(;;)switch(t){case"hex":return A(this,e,n);case"utf8":case"utf-8":return P(this,e,n);case"ascii":return S(this,e,n);case"binary":return O(this,e,n);case"base64":return L(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function w(t,e,n,i){n=Number(n)||0;var o=t.length-n;i?(i=Number(i))>o&&(i=o):i=o;var r=e.length;if(r%2!=0)throw new Error("Invalid hex string");i>r/2&&(i=r/2);for(var a=0;a<i;a++){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))throw new Error("Invalid hex string");t[n+a]=s}return a}function b(t,e,n,i){return G(H(e,t.length-n),t,n,i)}function E(t,e,n,i){return G(z(e),t,n,i)}function x(t,e,n,i){return E(t,e,n,i)}function M(t,e,n,i){return G(Y(e),t,n,i)}function T(t,e,n,i){return G(W(e,t.length-n),t,n,i)}function L(t,e,n){return 0===e&&n===t.length?X.fromByteArray(t):X.fromByteArray(t.slice(e,n))}function P(t,e,n){n=Math.min(t.length,n);for(var i=[],o=e;o<n;){var r=t[o],a=null,s=r>239?4:r>223?3:r>191?2:1;if(o+s<=n){var h,c,l,d;switch(s){case 1:r<128&&(a=r);break;case 2:h=t[o+1],128==(192&h)&&(d=(31&r)<<6|63&h)>127&&(a=d);break;case 3:h=t[o+1],c=t[o+2],128==(192&h)&&128==(192&c)&&(d=(15&r)<<12|(63&h)<<6|63&c)>2047&&(d<55296||d>57343)&&(a=d);break;case 4:h=t[o+1],c=t[o+2],l=t[o+3],128==(192&h)&&128==(192&c)&&128==(192&l)&&(d=(15&r)<<18|(63&h)<<12|(63&c)<<6|63&l)>65535&&d<1114112&&(a=d)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,i.push(a>>>10&1023|55296),a=56320|1023&a),i.push(a),o+=s}return I(i)}function I(t){var e=t.length;if(e<=Q)return String.fromCharCode.apply(String,t);for(var n="",i=0;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=Q));return n}function S(t,e,n){var i="";n=Math.min(t.length,n);for(var o=e;o<n;o++)i+=String.fromCharCode(127&t[o]);return i}function O(t,e,n){var i="";n=Math.min(t.length,n);for(var o=e;o<n;o++)i+=String.fromCharCode(t[o]);return i}function A(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var o="",r=e;r<n;r++)o+=B(t[r]);return o}function C(t,e,n){for(var i=t.slice(e,n),o="",r=0;r<i.length;r+=2)o+=String.fromCharCode(i[r]+256*i[r+1]);return o}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,n,i,r,a){if(!o.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>r||e<a)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range")}function _(t,e,n,i){e<0&&(e=65535+e+1);for(var o=0,r=Math.min(t.length-n,2);o<r;o++)t[n+o]=(e&255<<8*(i?o:1-o))>>>8*(i?o:1-o)}function k(t,e,n,i){e<0&&(e=4294967295+e+1);for(var o=0,r=Math.min(t.length-n,4);o<r;o++)t[n+o]=e>>>8*(i?o:3-o)&255}function V(t,e,n,i,o,r){if(e>o||e<r)throw new RangeError("value is out of bounds");if(n+i>t.length)throw new RangeError("index out of range");if(n<0)throw new RangeError("index out of range")}function U(t,e,n,i,o){return o||V(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),q.write(t,e,n,i,23,4),n+4}function j(t,e,n,i,o){return o||V(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),q.write(t,e,n,i,52,8),n+8}function N(t){if(t=F(t).replace(K,""),t.length<2)return"";for(;t.length%4!=0;)t+="=";return t}function F(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function B(t){return t<16?"0"+t.toString(16):t.toString(16)}function H(t,e){e=e||1/0;for(var n,i=t.length,o=null,r=[],a=0;a<i;a++){if((n=t.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(a+1===i){(e-=3)>-1&&r.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&r.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&r.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;r.push(n)}else if(n<2048){if((e-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function z(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function W(t,e){for(var n,i,o,r=[],a=0;a<t.length&&!((e-=2)<0);a++)n=t.charCodeAt(a),i=n>>8,o=n%256,r.push(o),r.push(i);return r}function Y(t){return X.toByteArray(N(t))}function G(t,e,n,i){for(var o=0;o<i&&!(o+n>=e.length||o>=t.length);o++)e[o+n]=t[o];return o}var X=t("base64-js"),q=t("ieee754"),$=t("isarray");n.Buffer=o,n.SlowBuffer=v,n.INSPECT_MAX_BYTES=50,o.poolSize=8192;var Z={};o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.foo=function(){return 42},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),o.TYPED_ARRAY_SUPPORT?(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array):(o.prototype.length=void 0,o.prototype.parent=void 0),o.isBuffer=function(t){return!(null==t||!t._isBuffer)},o.compare=function(t,e){if(!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,a=Math.min(n,i);r<a&&t[r]===e[r];)++r;return r!==a&&(n=t[r],i=e[r]),n<i?-1:i<n?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!$(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new o(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new o(e),r=0;for(n=0;n<t.length;n++){var a=t[n];a.copy(i,r),r+=a.length}return i},o.byteLength=g,o.prototype._isBuffer=!0,o.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):y.apply(this,arguments)},o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},o.prototype.compare=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:o.compare(this,t)},o.prototype.indexOf=function(t,e){function n(t,e,n){for(var i=-1,o=0;n+o<t.length;o++)if(t[n+o]===e[-1===i?0:o-i]){if(-1===i&&(i=o),o-i+1===e.length)return n+i}else i=-1;return-1}if(e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(e<0&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(o.isBuffer(t))return n(this,t,e);if("number"==typeof t)return o.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):n(this,[t],e);throw new TypeError("val must be string, number or Buffer")},o.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else if(isFinite(e))e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0);else{var o=i;i=e,e=0|n,n=o}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return E(this,t,e,n);case"binary":return x(this,t,e,n);case"base64":return M(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Q=4096;o.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var i;if(o.TYPED_ARRAY_SUPPORT)i=this.subarray(t,e),i.__proto__=o.prototype;else{var r=e-t;i=new o(r,void 0);for(var a=0;a<r;a++)i[a]=this[a+t]}return i.length&&(i.parent=this.parent||this),i},o.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var i=this[t],o=1,r=0;++r<e&&(o*=256);)i+=this[t+r]*o;return i},o.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var i=this[t+--e],o=1;e>0&&(o*=256);)i+=this[t+--e]*o;return i},o.prototype.readUInt8=function(t,e){return e||R(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return e||R(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return e||R(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var i=this[t],o=1,r=0;++r<e&&(o*=256);)i+=this[t+r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},o.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||R(t,e,this.length);for(var i=e,o=1,r=this[t+--i];i>0&&(o*=256);)r+=this[t+--i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},o.prototype.readInt8=function(t,e){return e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(t,e){e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(t,e){return e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return e||R(t,4,this.length),q.read(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return e||R(t,4,this.length),q.read(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return e||R(t,8,this.length),q.read(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return e||R(t,8,this.length),q.read(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,n,i){t=+t,e|=0,n|=0,i||D(this,t,e,n,Math.pow(2,8*n),0);var o=1,r=0;for(this[e]=255&t;++r<n&&(o*=256);)this[e+r]=t/o&255;return e+n},o.prototype.writeUIntBE=function(t,e,n,i){t=+t,e|=0,n|=0,i||D(this,t,e,n,Math.pow(2,8*n),0);var o=n-1,r=1;for(this[e+o]=255&t;--o>=0&&(r*=256);)this[e+o]=t/r&255;return e+n},o.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,1,255,0),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):_(this,t,e,!0),e+2},o.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):_(this,t,e,!1),e+2},o.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):k(this,t,e,!0),e+4},o.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},o.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var o=Math.pow(2,8*n-1);D(this,t,e,n,o-1,-o)}var r=0,a=1,s=t<0?1:0;for(this[e]=255&t;++r<n&&(a*=256);)this[e+r]=(t/a>>0)-s&255;return e+n},o.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var o=Math.pow(2,8*n-1);D(this,t,e,n,o-1,-o)}var r=n-1,a=1,s=t<0?1:0;for(this[e+r]=255&t;--r>=0&&(a*=256);)this[e+r]=(t/a>>0)-s&255;return e+n},o.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,1,127,-128),o.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):_(this,t,e,!0),e+2},o.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):_(this,t,e,!1),e+2},o.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):k(this,t,e,!0),e+4},o.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),o.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):k(this,t,e,!1),e+4},o.prototype.writeFloatLE=function(t,e,n){return U(this,t,e,!0,n)},o.prototype.writeFloatBE=function(t,e,n){return U(this,t,e,!1,n)},o.prototype.writeDoubleLE=function(t,e,n){return j(this,t,e,!0,n)},o.prototype.writeDoubleBE=function(t,e,n){return j(this,t,e,!1,n)},o.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,a=i-n;if(this===t&&n<e&&e<i)for(r=a-1;r>=0;r--)t[r+e]=this[r+n];else if(a<1e3||!o.TYPED_ARRAY_SUPPORT)for(r=0;r<a;r++)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},o.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),n<e)throw new RangeError("end < start");if(n!==e&&0!==this.length){if(e<0||e>=this.length)throw new RangeError("start out of bounds");if(n<0||n>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof t)for(i=e;i<n;i++)this[i]=t;else{var o=H(t.toString()),r=o.length;for(i=e;i<n;i++)this[i]=o[i%r]}return this}};var K=/[^+\/0-9A-Za-z-_]/g}).call(this,void 0!==o?o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":38,ieee754:39,isarray:40}],38:[function(t,e,n){!function(t){function e(t){var e=t.charCodeAt(0);return e===a||e===d?62:e===s||e===u?63:e<h?-1:e<h+10?e-h+26+26:e<l+26?e-l:e<c+26?e-c+26:void 0}function n(t){function n(t){c[d++]=t}var i,o,a,s,h,c;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;h="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,c=new r(3*t.length/4-h),a=h>0?t.length-4:t.length;var d=0;for(i=0,o=0;i<a;i+=4,o+=3)s=e(t.charAt(i))<<18|e(t.charAt(i+1))<<12|e(t.charAt(i+2))<<6|e(t.charAt(i+3)),n((16711680&s)>>16),n((65280&s)>>8),n(255&s);return 2===h?(s=e(t.charAt(i))<<2|e(t.charAt(i+1))>>4,n(255&s)):1===h&&(s=e(t.charAt(i))<<10|e(t.charAt(i+1))<<4|e(t.charAt(i+2))>>2,n(s>>8&255),n(255&s)),c}function i(t){function e(t){return o.charAt(t)}var n,i,r,a=t.length%3,s="";for(n=0,r=t.length-a;n<r;n+=3)i=(t[n]<<16)+(t[n+1]<<8)+t[n+2],s+=function(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}(i);switch(a){case 1:i=t[t.length-1],s+=e(i>>2),s+=e(i<<4&63),s+="==";break;case 2:i=(t[t.length-2]<<8)+t[t.length-1],s+=e(i>>10),s+=e(i>>4&63),s+=e(i<<2&63),s+="="}return s}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="undefined"!=typeof Uint8Array?Uint8Array:Array,a="+".charCodeAt(0),s="/".charCodeAt(0),h="0".charCodeAt(0),c="a".charCodeAt(0),l="A".charCodeAt(0),d="-".charCodeAt(0),u="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=i}(void 0===n?this.base64js={}:n)},{}],39:[function(t,e,n){n.read=function(t,e,n,i,o){var r,a,s=8*o-i-1,h=(1<<s)-1,c=h>>1,l=-7,d=n?o-1:0,u=n?-1:1,p=t[e+d];for(d+=u,r=p&(1<<-l)-1,p>>=-l,l+=s;l>0;r=256*r+t[e+d],d+=u,l-=8);for(a=r&(1<<-l)-1,r>>=-l,l+=i;l>0;a=256*a+t[e+d],d+=u,l-=8);if(0===r)r=1-c;else{if(r===h)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),r-=c}return(p?-1:1)*a*Math.pow(2,r-i)},n.write=function(t,e,n,i,o,r){var a,s,h,c=8*r-o-1,l=(1<<c)-1,d=l>>1,u=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:r-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-a))<1&&(a--,h*=2),e+=a+d>=1?u/h:u*Math.pow(2,1-d),e*h>=2&&(a++,h/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(e*h-1)*Math.pow(2,o),a+=d):(s=e*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;t[n+p]=255&s,p+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;t[n+p]=255&a,p+=f,a/=256,c-=8);t[n+p-f]|=128*m}},{}],40:[function(t,e,n){var i={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},{}]},{},[36]),e.a=M}).call(e,n(61),n(352)(t),n(26))},326:function(t,e,n){var i=n(3)(n(68),n(336),null,null);t.exports=i.exports},327:function(t,e,n){n(347);var i=n(3)(n(69),n(337),"data-v-2a5bfa54",null);t.exports=i.exports},328:function(t,e,n){var i=n(3)(n(70),n(339),null,null);t.exports=i.exports},329:function(t,e,n){var i=n(3)(n(71),n(342),null,null);t.exports=i.exports},330:function(t,e,n){var i=n(3)(n(72),n(338),null,null);t.exports=i.exports},331:function(t,e,n){n(348);var i=n(3)(n(74),n(340),"data-v-66d382e3",null);t.exports=i.exports},332:function(t,e,n){n(344);var i=n(3)(n(75),n(333),"data-v-09ad1f51",null);t.exports=i.exports},333:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticStyle:{width:"100%",height:"100%",margin:"0",border:"0",padding:"0"}})},staticRenderFns:[]}},334:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"demo-block"},[n("div",{staticClass:"demo-block-preview"},[t._t("preview")],2),t._v(" "),n("div",{staticClass:"demo-block-code"},[n("div",{staticClass:"demo-block-code-box"},[n("h3",[t._v("Vue Component & Webpack")]),t._v(" "),n("div",{staticClass:"demo-block-code-box-content"},[n("pre",[t._v("             "),n("code",{ref:"vueCode",staticClass:"html"},[t._v(t._s(t._f("code")(t.vueCode)))]),t._v("\n        ")])])]),t._v(" "),n("div",{staticClass:"demo-block-code-box"},[n("h3",[t._v("HTML & JS")]),t._v(" "),n("div",{staticClass:"demo-block-code-box-content"},[n("pre",[t._v("          "),n("code",{ref:"htmlCode",staticClass:"html"},[t._v(t._s(t._f("code")(t.htmlCode))+"\n          ")]),t._v("\n        ")])])])])])},staticRenderFns:[]}},335:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"demos"},[n("div",{staticClass:"demos-content"},[n("ul",{staticClass:"demos-menu"},[n("li",{staticClass:"demos-menu-title"},[t._v("demos")]),t._v(" "),n("li",{staticClass:"demos-menu-item"},[n("router-link",{attrs:{to:"demo-pano"}},[t._v("basic panorama")])],1),t._v(" "),n("li",{staticClass:"demos-menu-item"},[n("router-link",{attrs:{to:"demo-cube-pano"}},[t._v("Cube Faces")])],1),t._v(" "),n("li",{staticClass:"demos-menu-item"},[n("router-link",{attrs:{to:"demo-video-pano"}},[t._v("Video Pano")])],1),t._v(" "),n("li",{staticClass:"demos-menu-item"},[n("router-link",{attrs:{to:"demo-scene"}},[t._v("Scene with hotspot")])],1),t._v(" "),n("li",{staticClass:"demos-menu-item"},[n("router-link",{attrs:{to:"demo-tour"}},[t._v("VR Tour")])],1)]),t._v(" "),n("div",{staticClass:"demos-pages"},[n("router-view")],1)])])},staticRenderFns:[]}},336:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("demo-block",{attrs:{"vue-code":t.code,"html-code":t.htmlCode}},[n("template",{slot:"preview"},[n("Pano",{attrs:{type:"cube",source:"assets/faces/pano_%s.jpg"},on:{"on-load":t.onLoad}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"demo-loading"})],1)],2)},staticRenderFns:[]}},337:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("demo-block",{attrs:{"vue-code":t.code,"html-code":t.htmlCode}},[n("template",{slot:"preview"},[n("div",{staticClass:"info"},[t._v("\n      Pano index:"+t._s(t.index)+"\n      "),n("button",{on:{click:t.change}},[t._v("Toggle")])]),t._v(" "),n("Pano",{attrs:{source:t.urls[t.index]},on:{"on-load":t.onLoad}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"demo-loading"})],1)],2)},staticRenderFns:[]}},338:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("demo-block",{attrs:{"vue-code":t.code,"html-code":t.htmlCode}},[n("template",{slot:"preview"},[n("Pano",{attrs:{type:"video",source:"assets/ClashofClans.mp4"},on:{"on-load":t.onLoad}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"demo-loading"})],1)],2)},staticRenderFns:[]}},339:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("demo-block",{attrs:{"vue-code":t.code,"html-code":t.htmlCode}},[n("template",{slot:"preview"},[n("Scene",{attrs:{pano:t.scene.pano,position:t.scene.position,rotation:t.scene.rotation,links:t.scene.links},on:{"on-load-start":t.onLoadStart,"on-load":t.onLoad}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"demo-loading"})],1)],2)},staticRenderFns:[]}},340:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticStyle:{width:"100%",height:"100%",margin:"0",border:"0",padding:"0"}})},staticRenderFns:[]}},341:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"v-pano"})},staticRenderFns:[]}},342:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("demo-block",{attrs:{"vue-code":t.code,"html-code":t.htmlCode}},[n("template",{slot:"preview"},[n("Tour",{attrs:{scenes:t.scenes},on:{"on-load-start":t.onLoadStart,"on-load":t.onLoad}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"demo-loading"})],1)],2)},staticRenderFns:[]}},344:function(t,e,n){var i=n(130);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(13)("4136a65b",i,!0)},345:function(t,e,n){var i=n(131);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(13)("56304fc1",i,!0)},346:function(t,e,n){var i=n(132);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(13)("48e2ad6a",i,!0)},347:function(t,e,n){var i=n(133);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(13)("740377fa",i,!0)},348:function(t,e,n){var i=n(134);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(13)("356c544a",i,!0)},349:function(t,e,n){var i=n(135);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n(13)("49e91b24",i,!0)},42:function(t,e,n){n(349);var i=n(3)(n(73),n(341),null,null);t.exports=i.exports},62:function(t,e,n){"use strict";var i=n(43),o=n(343),r=n(65);i.a.use(o.a);var a=r.a.map(function(t){var e=t.name;return{path:"/"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),name:e,component:t}});console.log(a),a.push({path:"*",redirect:"/demo-pano"}),e.a=new o.a({routes:a})},63:function(t,e,n){n(346);var i=n(3)(n(66),n(335),null,null);t.exports=i.exports},64:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(43),o=n(63),r=n.n(o),a=n(62);new i.a({el:"#app",router:a.a,render:function(t){return t(r.a)}})},65:function(t,e,n){"use strict";n.d(e,"a",function(){return p});var i=n(327),o=n.n(i),r=n(326),a=n.n(r),s=n(330),h=n.n(s),c=n(328),l=n.n(c),d=n(329),u=n.n(d),p=[o.a,a.a,h.a,l.a,u.a]},66:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"App"}},67:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(136),o=(n.n(i),n(138)),r=n.n(o),a=function(t){return t.replace(/#scripts#/gi,'\n  <script src="vue.js"><\/script> \n  <script src="vue-vr.min.js"><\/script>')};e.default={name:"App",props:{vueCode:{type:String,default:""},htmlCode:{type:String,default:"// TODO"}},mounted:function(){r.a.highlightBlock(this.$refs.vueCode),r.a.highlightBlock(this.$refs.htmlCode)},data:function(){return{}},filters:{code:function(t){return a(t)}},components:{}}},68:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(18),o=n.n(i),r=n(42),a=n.n(r);e.default={name:"DemoCubePano",data:function(){return{code:"\n<template>\n    <Pano\n        @on-load=\"onLoad\"\n        type='cube'\n        source=\"assets/faces/pano_%s.jpg\"></Pano>\n</template>\n<script>\n    import { Pano } from 'vuejs-vr'\n\n    export default {\n        components: {\n            Pano\n        }\n    }\n <\/script>",htmlCode:'\n<body>\n    <div id="app">\n        <Pano\n            @on-load="onLoad"\n            type=\'cube\'\n            source="assets/faces/pano_%s.jpg">\n        </Pano>\n    </div>\n    #scripts#\n    <script>\n        new Vue({\n            el: \'#app\'\n        })\n    <\/script>\n</body>\n',loading:!0}},methods:{onLoad:function(){this.loading=!1}},components:{Pano:a.a,DemoBlock:o.a}}},69:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(42),o=n.n(i),r=n(18),a=n.n(r);e.default={name:"DemoPano",data:function(){return{code:"\n<template>\n    <Pano\n        @on-load=\"onLoad\"\n        :source=\"urls[index]\">\n    </Pano>\n</template>\n\n<script>\n    import { Pano } from 'vue-vr'\n\n    export default {\n        components: {\n            Pano\n        },\n        data () {\n          return {\n            urls: [\n              '../assets/equirectangular.jpg',\n              '../assets/pano.png'\n            ],\n            index: 0\n          }\n        },\n    }\n<\/script>\n",htmlCode:'\n<body>\n    <div id="app">\n        <Pano\n            @on-load="onLoad"\n            :source="urls[index]">\n        </Pano>\n    </div>\n    #scripts#\n    <script>\n        new Vue({\n            el: \'#app\'\n        })\n    <\/script>\n</body>',loading:!0,urls:["assets/equirectangular.jpg","assets/pano.png"],index:0}},methods:{onLoad:function(){this.loading=!1},change:function(){this.index=1-this.index}},components:{Pano:o.a,DemoBlock:a.a}}},70:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(18),o=n.n(i),r=n(331),a=n.n(r);e.default={name:"DemoScene",data:function(){return{code:"\n<template>\n    <Scene\n        @on-load=\"onLoad\"\n        :scene='scene'>\n\n    </Scene>\n    <div\n      class=\"demo-loading\"\n      v-show=\"loading\"></div>\n      \n</template>\n\n<script>\n    import { Scene } from 'vue-vr'\n\n    export default {\n        components: {\n            Scene\n        },\n        data(){\n          return {\n            scene: {\n              key: 'M4wOy2s',\n              panorama: {\n                source: 'assets/equirectangular.jpg',\n                type: 'image'\n              },\n              x: 0,\n              y: 0,\n              z: 0,\n              rotation:90\n            }\n          }\n        }\n    }\n<\/script>",htmlCode:'\n<body>\n    <div id="app">\n        <Scene\n          @on-load="onLoad"\n          :scene=\'scene\'>\n      </Scene>\n      <div\n        class="demo-loading"\n        v-show="loading"></div>\n    </div>\n    #scripts#\n    <script>\n        new Vue({\n            el: \'#app\'\n        })\n    <\/script>\n</body>',loading:!0,scene:{pano:{source:"assets/faces/pano_%s.jpg",type:"cube"},position:{x:0,y:0,z:0},rotation:{x:0,y:135*Math.PI/180,z:0},links:[{sceneId:"scene1",position:{x:100,y:0,z:-100}},{sceneId:"scene2",position:{x:200,y:0,z:-20}}]}}},methods:{onLoad:function(){console.log("onLoad"),this.loading=!1},onLoadStart:function(){console.log("onLoadStart"),this.loading=!0}},components:{Scene:a.a,DemoBlock:o.a}}},71:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(18),o=n.n(i),r=n(332),a=n.n(r);e.default={name:"DemoTour",data:function(){return{code:"\n<template>\n    <Tour\n        @on-load=\"onLoad\"\n        :scenes='scenes'>\n\n    </Tour>\n    <div\n      class=\"demo-loading\"\n      v-show=\"loading\"></div>\n      \n</template>\n\n<script>\n    import { Tour } from 'vue-vr'\n\n    export default {\n        components: {\n            Tour\n        },\n        data(){\n          return {\n            scenes: [{\n              key: 'M4wOy2s',\n              panorama: {\n                source: 'assets/equirectangular.jpg',\n                type: 'image'\n              },\n              x: 0,\n              y: 0,\n              z: 0,\n              rx: 0,\n              rz: 0,\n              ry: 90,\n              connections: [\n                'eIm7la',\n                'eId9l0',\n                'fK2dL7l'\n              ]\n            },\n            {\n              key: 'eIm7la',\n              panorama: {\n                source: 'assets/faces/pano_%s.jpg',\n                type: 'cube'\n              },\n              x: 100,\n              y: 0,\n              z: 200,\n              rx: 0,\n              rz: 0,\n              ry: 0,\n              connections: [\n                'M4wOy2s'\n              ]\n            },\n            {\n              key: 'eId9l0',\n              panorama: {\n                source: 'assets/faces/pano_%s.jpg',\n                type: 'cube'\n              },\n              x: 150,\n              y: 0,\n              z: -300,\n              rx: 0,\n              rz: 0,\n              ry: 0,\n              connections: [\n                'M4wOy2s'\n              ]\n            },\n            {\n              key: 'fK2dL7l',\n              panorama: {\n                source: 'assets/faces/pano_%s.jpg',\n                type: 'cube'\n              },\n              x: -150,\n              y: 0,\n              z: -300,\n              rx: 0,\n              rz: 0,\n              ry: 0,\n              connections: [\n                'M4wOy2s'\n              ]\n            }]\n          }\n        }\n    }\n<\/script>",htmlCode:'\n<body>\n    <div id="app">\n        <Tour\n          @on-load="onLoad"\n          :scenes=\'scenes\'>\n      </Tour>\n      <div\n        class="demo-loading"\n        v-show="loading"></div>\n    </div>\n    #scripts#\n    <script>\n        new Vue({\n            el: \'#app\'\n        })\n    <\/script>\n</body>',loading:!0,scenes:[{key:"M4wOy2s",panorama:{source:"assets/equirectangular.jpg",type:"image"},x:0,y:0,z:0,rx:0,rz:0,ry:90,connections:["eIm7la","eId9l0","fK2dL7l"]},{key:"eIm7la",panorama:{source:"assets/faces/pano_%s.jpg",type:"cube"},x:100,y:0,z:200,rx:0,rz:0,ry:0,connections:["M4wOy2s"]},{key:"eId9l0",panorama:{source:"assets/faces/pano_%s.jpg",type:"cube"},x:150,y:0,z:-300,rx:0,rz:0,ry:0,connections:["M4wOy2s"]},{key:"fK2dL7l",panorama:{source:"assets/faces/pano_%s.jpg",type:"cube"},x:-150,y:0,z:-300,rx:0,rz:0,ry:0,connections:["M4wOy2s"]}]}},methods:{onLoad:function(){console.log("onLoad"),this.loading=!1},onLoadStart:function(){console.log("onLoadStart"),this.loading=!0}},components:{Tour:a.a,DemoBlock:o.a},mounted:function(){this.initialScene=this.scenes[0].key}}},72:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(18),o=n.n(i),r=n(42),a=n.n(r);e.default={name:"DemoVideoPano",data:function(){return{code:"\n<template>\n    <Pano\n        @on-load=\"onLoad\"\n        type='video'\n        source=\"assets/ClashofClans.mp4\">\n    </Pano>\n</template>\n\n<script>\n    import { Pano } from 'vue-vr'\n\n    export default {\n        components: {\n            Pano\n        }\n    }\n<\/script>",htmlCode:'\n<body>\n    <div id="app">\n        <Pano\n            @on-load="onLoad"\n            type=\'video\'\n            source="assets/ClashofClans.mp4">\n        </Pano>\n    </div>\n    #scripts#\n    <script>\n        new Vue({\n            el: \'#app\'\n        })\n    <\/script>\n</body>',loading:!0}},methods:{onLoad:function(){this.loading=!1}},components:{Pano:a.a,DemoBlock:o.a}}},73:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(27),o=console.log.bind(console);e.default={name:"Pano",props:{source:{type:String,default:""},type:{type:String,default:"image"},width:{type:Number,default:100},height:{type:Number,default:100}},data:function(){return{size:{width:this.width,height:this.height},viewer:null,panorama:null}},created:function(){window.addEventListener("resize",this.onResize,!1)},destroyed:function(){this.panorama&&this.panorama.dispose&&this.panorama.dispose()},mounted:function(){void 0!==this.width&&void 0!==this.height||(this.size={width:this.$el.offsetWidth,height:this.$el.offsetHeight}),this.viewer=new i.a.Viewer({container:this.$el,cameraFov:100}),this.loadPano()},watch:{source:function(){this.viewer&&this.panorama&&this.loadPano()}},methods:{onResize:function(){var t=this;void 0!==this.width&&void 0!==this.height||this.$nextTick(function(){t.size={width:t.$el.offsetWidth,height:t.$el.offsetHeight}})},loadPano:function(){if(o("this.source = "+this.source),this.source){var t=void 0;switch(this.type){case"cube":var e=this.source.replace("%s","l"),n=this.source.replace("%s","f"),r=this.source.replace("%s","r"),a=this.source.replace("%s","b"),s=this.source.replace("%s","u"),h=this.source.replace("%s","d");t=new i.a.CubePanorama([r,e,s,h,n,a]);break;case"video":t=new i.a.VideoPanorama(this.source,{autoplay:!0});break;default:t=new i.a.ImagePanorama(this.source)}this.setPano(t)}},setPano:function(t){if(t){this.panorama&&this.viewer.remove(this.panorama),this.panorama=t,this.viewer.add(this.panorama),this.viewer.setPanorama(this.panorama);var e=this;this.panorama.addEventListener("load",function(){e.$emit("on-load")})}}}}},74:function(t,e,n){"use strict";function i(t){var e=new l.RingGeometry(8,13,100,100),n=new l.MeshPhongMaterial({color:1668818,emissive:16777215,transparent:!0,opacity:1,side:l.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4,polygonOffsetUnits:-4}),i=new l.CircleGeometry(9,32,32),o=new l.MeshPhongMaterial;o.copy(n),o.opacity=.5;var r=new l.Mesh(i),a=new l.Mesh(e),h=new l.Geometry;r.updateMatrix(),h.merge(r.geometry,r.matrix,0),a.updateMatrix(),h.merge(a.geometry,a.matrix,1);var c=new l.Mesh(h,new l.MeshFaceMaterial([n,o]));return c.rotation.set(s(90),0,0),c.position.set(t.position.x,t.position.y-100,t.position.z),c.type="hotspot",c.targetScene=t,c}function o(t,e){var n=r(),i=new l.MeshBasicMaterial({transparent:!0,opacity:.8,color:1668818,emissive:16777215,side:l.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4,polygonOffsetUnits:-4}),o=new l.Mesh(n,i),c=e.x,d=e.z,u=t.x,p=t.z,f=h(Math.atan2(d-p,c-u));o.rotation.set(s(90),0,s(f));var m=a(f,0);return o.position.set(m.x,m.y,m.z),o.type="arrow",o.targetScene=e,o}function r(){var t=.2/3,e=.1*Math.cos(60*l.Math.DEG2RAD),n=.1*Math.sin(60*l.Math.DEG2RAD),i=new l.Shape;return i.moveTo(t,0),i.lineTo(t-e,n),i.lineTo(-e,n),i.lineTo(0,0),i.lineTo(-e,-n),i.lineTo(t-e,-n),i.lineTo(t,0),new l.ShapeGeometry(i)}function a(t,e){t+=90;var n=-.5*Math.sin(s(e)),i=-.5*Math.cos(s(e)),o=i*Math.sin(s(-t)),r=i*Math.cos(s(-t));return new l.Vector3(o,n,r)}function s(t){return t*Math.PI/180}function h(t){return 180*t/Math.PI}Object.defineProperty(e,"__esModule",{value:!0});var c=n(27),l=n(41),d=console.log.bind(console);e.default={name:"Scene",props:{pano:{type:Object,default:function(){return{}}},position:{type:Object,default:function(){return{x:0,y:0,z:0}}},rotation:{type:Object,default:function(){return{x:0,y:0,z:0}}},links:{type:Array,default:function(){return[]}},width:{type:Number,default:void 0},height:{type:Number,default:void 0}},data:function(){return{size:{width:this.width,height:this.height},scene_index:-1,viewer:null,panorama:null,hotspots:[]}},created:function(){window.addEventListener("resize",this.onResize,!1)},mounted:function(){void 0!==this.width&&void 0!==this.height||(this.size={width:this.$el.offsetWidth,height:this.$el.offsetHeight}),this.viewer=new c.a.Viewer({container:this.$el,cameraFov:100}),this.loadScene()},methods:{onResize:function(){var t=this;void 0!==this.width&&void 0!==this.height||this.$nextTick(function(){t.size={width:t.$el.offsetWidth,height:t.$el.offsetHeight}})},loadScene:function(){var t=this;if(d("this.pano = "+this.pano),this.pano){var e=this.pano.source;switch(this.pano.type){case"cube":var n=e.replace("%s","l"),r=e.replace("%s","f"),a=e.replace("%s","r"),s=e.replace("%s","b"),h=e.replace("%s","u"),u=e.replace("%s","d");this.panorama=new c.a.CubePanorama([a,n,h,u,r,s]);break;case"video":this.panorama=new c.a.VideoPanorama(e,{autoplay:!0});break;default:this.panorama=new c.a.ImagePanorama(e)}this.initViewer();var p=new l.Object3D;this.links.forEach(function(e,n){d(n);var r=i(e);t.viewer.add(r),t.hotspots.push(r);var a=o(t.position,e);a.addEventListener("mouseover",function(){d("hoverred")}),p.add(a)});var f=this,m=new l.Raycaster,v=null;this.viewer.container.addEventListener("click",function(t){v&&(d(v.targetScene),f.scene_index=f.getSceneIndexByKey(v.targetScene.key),f.viewer.remove(f.panorama),f.loadScene(),v=null)}),this.viewer.container.addEventListener("mousemove",function(t){var e=new l.Vector2,n=f.viewer.camera;e.x=(t.clientX-f.$el.parentElement.offsetLeft)/f.viewer.container.offsetWidth*2-1,e.y=-(t.clientY-f.$el.parentElement.offsetTop)/f.viewer.container.offsetHeight*2+1,m.setFromCamera(e,n);var i=m.intersectObjects(f.viewer.scene.children,!0),o=null;i.length>=0&&i.forEach(function(t,e){"hotspot"!==t.object.type&&"arrow"!==t.object.type||(o=t.object)}),o?(v&&(v.material.color&&v.material.color.setHex(v.currentHex),v.scale.set(1,1,1)),v=i[0].object,v.material.color&&(v.currentHex=v.material.color.getHex()),v.material.color&&v.material.color.setHex(16776960),v.scale.set(1.2,1.2,1.2)):(v&&(v.material.color&&v.material.color.setHex(v.currentHex),v.scale.set(1,1,1)),v=null)}),this.viewer.addUpdateCallback(function(){this.position.copy(f.viewer.control.target),this.rotation.z=f.viewer.camera.rotation.z,this.translateZ(0),this.translateX(0),this.translateY(-1),this.translateZ(0)}.bind(p)),this.viewer.add(p),this.panorama.addEventListener("load",function(){f.$emit("on-load")})}},initViewer:function(){this.viewer.add(this.panorama),this.viewer.camera.near=.001,this.viewer.camera.target=this.panorama.position,this.viewer.panorama.rotation.set(0,Math.PI,0),this.viewer.panorama.position.copy(this.position)}}}},75:function(t,e,n){"use strict";function i(t,e){var n={x:e.x,y:e.y,z:e.z},i=new l.RingGeometry(8,13,100,100),o=new l.MeshPhongMaterial({color:1668818,emissive:16777215,transparent:!0,opacity:1,side:l.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4,polygonOffsetUnits:-4}),r=new l.CircleGeometry(9,32,32),a=new l.MeshPhongMaterial;a.copy(o),a.opacity=.5;var h=new l.Mesh(r),c=new l.Mesh(i),d=new l.Geometry;h.updateMatrix(),d.merge(h.geometry,h.matrix,0),c.updateMatrix(),d.merge(c.geometry,c.matrix,1);var u=new l.Mesh(d,new l.MeshFaceMaterial([o,a]));return u.rotation.set(s(90),0,0),u.position.set(n.x,n.y-100,n.z),u.type="hotspot",u.targetScene=e,u}function o(t,e){var n=r(),i=new l.MeshBasicMaterial({transparent:!0,opacity:.8,color:1668818,emissive:16777215,side:l.DoubleSide,polygonOffset:!0,polygonOffsetFactor:-4,polygonOffsetUnits:-4}),o=new l.Mesh(n,i),c=e.x,d=e.z,u=t.x,p=t.z,f=h(Math.atan2(d-p,c-u));o.rotation.set(s(90),0,s(f));var m=a(f,0);return o.position.set(m.x,m.y,m.z),o.type="arrow",o.targetScene=e,o}function r(){var t=.2/3,e=.1*Math.cos(60*l.Math.DEG2RAD),n=.1*Math.sin(60*l.Math.DEG2RAD),i=new l.Shape;return i.moveTo(t,0),i.lineTo(t-e,n),i.lineTo(-e,n),i.lineTo(0,0),i.lineTo(-e,-n),i.lineTo(t-e,-n),i.lineTo(t,0),new l.ShapeGeometry(i)}function a(t,e){t+=90;var n=-.5*Math.sin(s(e)),i=-.5*Math.cos(s(e)),o=i*Math.sin(s(-t)),r=i*Math.cos(s(-t));return new l.Vector3(o,n,r)}function s(t){return t*Math.PI/180}function h(t){return 180*t/Math.PI}Object.defineProperty(e,"__esModule",{value:!0});var c=n(27),l=n(41),d=console.log.bind(console);e.default={name:"Tour",props:{scenes:{type:Array,default:function(){return[]}},sceneIndex:{type:Number,default:0},width:{type:Number,default:void 0},height:{type:Number,default:void 0}},data:function(){return{size:{width:this.width,height:this.height},scene_index:-1,viewer:null,panorama:null,hotspots:[],arrowGroup:null}},created:function(){window.addEventListener("resize",this.onResize,!1)},mounted:function(){void 0!==this.width&&void 0!==this.height||(this.size={width:this.$el.offsetWidth,height:this.$el.offsetHeight}),this.viewer=new c.a.Viewer({container:this.$el,cameraFov:100}),-1===this.scene_index&&this.loadScene(this.sceneIndex)},methods:{onResize:function(){var t=this;void 0!==this.width&&void 0!==this.height||this.$nextTick(function(){t.size={width:t.$el.offsetWidth,height:t.$el.offsetHeight}})},getSceneIndexByKey:function(t){for(var e=0;e<this.scenes.length;e++)if(this.scenes[e].key===t)return e;return-1},loadScene:function(t){var e=this;if(this.$emit("on-load-start"),d("this.scenes = "+this.scenes),this.scenes&&0!==this.scenes.length&&this.scene_index!==t){this.scene_index=t;var n=this.scenes[t],r=n.panorama,a=r.source;switch(r.type){case"cube":var s=a.replace("%s","l"),h=a.replace("%s","f"),u=a.replace("%s","r"),p=a.replace("%s","b"),f=a.replace("%s","u"),m=a.replace("%s","d");this.panorama=new c.a.CubePanorama([u,s,f,m,h,p]);break;case"video":this.panorama=new c.a.VideoPanorama(a,{autoplay:!0}),d("this is video");break;default:this.panorama=new c.a.ImagePanorama(a)}this.viewer.camera.near=.001,this.viewer.camera.position.set(n.x,n.y,n.z),this.viewer.camera.translateZ(1),this.viewer.add(this.panorama),this.viewer.panorama.rotation.set(0,Math.PI,0),this.panorama.parent.rotation.set(0,Math.PI,0),this.viewer.panorama.position.set(n.x,n.y,n.z),this.viewer.control.target=this.viewer.panorama.position,d(this.viewer),d("panorama = ",this.panorama),this.arrowGroup&&this.viewer.remove(this.arrowGroup),this.hotspots&&this.hotspots.forEach(function(t){e.viewer.remove(t)}),this.arrowGroup=new l.Object3D,n.connections.forEach(function(t){d("connections key = ",t);var r=e.getSceneIndexByKey(t);if(d("connections index = ",r),-1!==r){var a=i(n,e.scenes[r]);e.viewer.add(a),e.hotspots.push(a);var s=o(n,e.scenes[r]);s.addEventListener("mouseover",function(){d("hoverred")}),e.arrowGroup.add(s)}});var v=this;new l.Raycaster;this.viewer.container.addEventListener("click",function(t){Date.now()}),this.viewer.add(this.arrowGroup),this.panorama.addEventListener("load",function(){v.$emit("on-load")})}}}};var u=1e3;Date.now()}},[64]);
//# sourceMappingURL=app.cfded10c814f18849710.js.map